"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6840],{6840:(A,Z,u)=>{u.r(Z),u.d(Z,{SettingsPageModule:()=>n});var d=u(6814),c=u(95),f=u(7027),v=u(9801),h=u(5861),y=u(3009),e=u(6689),S=u(6815),b=u(5423),C=u(202);function P(t,o){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const r=e.oxw();e.xp6(1),e.hij("",r.magasinParDefaut," est actuellement le magasin par d\xe9faut")}}const m=[{path:"",component:(()=>{var t;class o{constructor(i,s,l,a){this.alertController=i,this.utility=s,this.storage=l,this.magasinService=a,this.magasinParDefaut="",this.isOnline=!0,this.isCourseRapide=!0,this.montantBudget=1e4}ngOnInit(){var i=this;return(0,h.Z)(function*(){yield i.refresh()})()}refresh(){var i=this;return(0,h.Z)(function*(){var s;const l=yield i.utility.getConnexionInfo();i.connexionInfo=l,i.isOnline=l.isOnline,i.isCourseRapide=l.isCourseRapide,i.montantBudget=l.budget,i.magasinParDefaut=void 0===(null===(s=l.magasinParDefaut)||void 0===s?void 0:s.libelle)?"1":l.magasinParDefaut.libelle})()}setmagasinParDefaut(){var i=this;return(0,h.Z)(function*(){const s=yield i.magasinService.get(),l=[];var p;s.map(p=>{l.push({type:"radio",label:p.libelle,value:p,checked:i.magasinParDefaut===p.libelle})}),yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Magasin par d\xe9faut",inputs:l,buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(p=(0,h.Z)(function*(x){const T=yield i.utility.getConnexionInfo();T.magasinParDefaut=x,i.magasinParDefaut=x.libelle,yield i.storage.set(y.K.InfoConnexion,T)}),function(T){return p.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}synchroniser(){var i=this;return(0,h.Z)(function*(){yield i.storage.synchroniserAvecFirestore().then((0,h.Z)(function*(){yield i.utility.popUp("Synchronisation termin\xe9e")}))})()}setModeOnline(i){var s=this;return(0,h.Z)(function*(){const l=i.detail.checked,a=yield s.utility.getConnexionInfo();a.isOnline=l,yield s.utility.putConnexionInfo(a),yield s.refresh()})()}setModeCourseRapide(i){var s=this;return(0,h.Z)(function*(){const l=i.detail.checked,a=yield s.utility.getConnexionInfo();a.isCourseRapide=l,yield s.utility.putConnexionInfo(a),yield s.refresh()})()}consoleLog(i){var s=this;return(0,h.Z)(function*(){const l=yield s.storage.get(i);console.log(l)})()}updateBudget(){var i=this;return(0,h.Z)(function*(){const s=yield i.utility.getConnexionInfo();var a;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"D\xe9finir un budget",inputs:[{type:"number",name:"budget",placeholder:s.budget.toString()}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(a=(0,h.Z)(function*(p){s.budget=""===p.budget?s.budget:p.budget,yield i.storage.set(y.K.InfoConnexion,s),yield i.refresh()}),function(x){return a.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(f.Br),e.Y36(S.t),e.Y36(b.V),e.Y36(C.t))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-settings"]],decls:54,vars:5,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["button","","detail","true",3,"click"],[3,"checked","ionChange"],[4,"ngIf"],["button","","detail","true","routerLink","/historique-prix"],["button","","detail","true","routerLink","/budgets"],["button","","detail","true","routerLink","/utilisateur-liste"],["button","","detail","true","routerLink","/utilisateur-groupes"]],template:function(i,s){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Param\xe8tres g\xe9n\xe9raux"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-item-group")(8,"ion-item-divider")(9,"ion-label"),e._uU(10,"Synchronisation"),e.qZA()(),e.TgZ(11,"ion-item",3),e.NdJ("click",function(){return s.synchroniser()}),e.TgZ(12,"ion-label")(13,"h3"),e._uU(14,"Synchroniser avec firebase"),e.qZA()()(),e.TgZ(15,"ion-item")(16,"ion-toggle",4),e.NdJ("ionChange",function(a){return s.setModeOnline(a)}),e._uU(17,"Mode Online"),e.qZA()()(),e.TgZ(18,"ion-item-group")(19,"ion-item-divider")(20,"ion-label"),e._uU(21,"G\xe9n\xe9ral"),e.qZA()(),e.TgZ(22,"ion-item",3),e.NdJ("click",function(){return s.setmagasinParDefaut()}),e.TgZ(23,"ion-label")(24,"h3"),e._uU(25,"Magasin par d\xe9faut"),e.qZA(),e.YNc(26,P,2,1,"p",5),e.qZA()(),e.TgZ(27,"ion-item")(28,"ion-toggle",4),e.NdJ("ionChange",function(a){return s.setModeCourseRapide(a)}),e._uU(29,"Mode course rapide"),e.qZA()()(),e.TgZ(30,"ion-item-group")(31,"ion-item-divider")(32,"ion-label"),e._uU(33,"Statistiques"),e.qZA()(),e.TgZ(34,"ion-item",6)(35,"ion-label")(36,"h3"),e._uU(37,"Historique des prix"),e.qZA()()(),e.TgZ(38,"ion-item",7)(39,"ion-label")(40,"h3"),e._uU(41,"Gestion du budget"),e.qZA()()()(),e.TgZ(42,"ion-item-group")(43,"ion-item-divider")(44,"ion-label"),e._uU(45,"S\xe9curit\xe9"),e.qZA()(),e.TgZ(46,"ion-item",8)(47,"ion-label")(48,"h3"),e._uU(49,"Utilisateurs"),e.qZA()()(),e.TgZ(50,"ion-item",9)(51,"ion-label")(52,"h3"),e._uU(53,"Groupes"),e.qZA()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("checked",s.isOnline),e.xp6(10),e.Q6J("ngIf",""!==s.magasinParDefaut),e.xp6(2),e.Q6J("checked",s.isCourseRapide))},dependencies:[d.O5,f.Sm,f.W2,f.Gu,f.Ie,f.rH,f.Ub,f.Q$,f.fG,f.wd,f.ho,f.sr,f.w,f.YI,v.rH]}),o})()}];let I=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(m),v.Bz]}),o})(),n=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,c.u5,f.Pc,I]}),o})()},9825:(A,Z,u)=>{u.d(Z,{f:()=>d});var d=function(c){return c.POST="POST",c.PUT="PUT",c.DELETE="DELETE",c}(d||{})},5423:(A,Z,u)=>{u.d(Z,{V:()=>P});var d=u(5861),c=u(3009),f=u(9825),v=u(6689),h=u(2014),y=u(2386),e=u(9392),S=u(3182),b=u(553);let C=(()=>{var g;class m{constructor(n){this.firestore=n}post(n,t,o){return(0,d.Z)(function*(){const r=(0,S.ZF)(b.N.firebaseConfig),i=(0,e.ad)(r);yield(0,y.pl)((0,y.JU)(i,n,o),t)})()}getAll(n){var t=this;return(0,d.Z)(function*(){const o=yield(0,y.hJ)(t.firestore,n);return(0,y.BS)(o)})()}put(n,t,o){var r=this;return(0,d.Z)(function*(){const i=(0,y.JU)(r.firestore,n+"/"+t);return(0,y.r7)(i,o)})()}delete(n,t,o){var r=this;return(0,d.Z)(function*(){const i=(0,y.JU)(r.firestore,n+"/"+t);return(0,y.oe)(i)})()}}return(g=m).\u0275fac=function(n){return new(n||g)(v.LFG(y.gg))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),m})(),P=(()=>{var g;class m{constructor(n,t){this.storage=n,this.firestore=t}postAll(n,t){var o=this;return(0,d.Z)(function*(){(yield o.getConnexionInfo()).isOnline&&(yield(yield t.filter(s=>!s.isFirebase)).map(function(){var s=(0,d.Z)(function*(l){l.isFirebase=!0,yield o.firestore.post(n,l,l.id.toString())});return function(l){return s.apply(this,arguments)}}())),yield o.storage.set(n,t)})()}parseDate(n){const o=new Date(n).getTime();return{nanoseconds:o%1e3*1e6,seconds:Math.floor(o/1e3)}}post(n,t){var o=this;return(0,d.Z)(function*(){var r=yield o.getAll(n);t.id=Number(new Date),t.createdOn=o.parseDate(new Date),t.modifiedOn=null,t.deletedOn=null,t.isFirebase=!1,r.push(t),yield o.postAll(n,r)})()}get(n){var t=this;return(0,d.Z)(function*(){return yield(yield t.storage.get(n)).filter(r=>""===r.deletedOn||null===r.deletedOn||void 0!==r.deletedOn)})()}getAll(n){var t=this;return(0,d.Z)(function*(){return yield t.storage.get(n)})()}getIndex(n,t){var o=this;return(0,d.Z)(function*(){return yield(yield o.getAll(n)).findIndex(i=>i.id===t)})()}put(n,t){var o=this;return(0,d.Z)(function*(){const r=yield o.getAll(n),i=yield o.getIndex(n,t.id);r[i]=t,r[i].modifiedOn=new Date,(yield o.getConnexionInfo()).isOnline?yield o.firestore.put(n,t.id.toString(),t):r[i].isFirebase&&(r[i].firebaseMethod=f.f.PUT),yield o.postAll(n,r)})()}delete(n,t){var o=this;return(0,d.Z)(function*(){const r=yield o.getAll(n),i=yield o.getIndex(n,t.id);r[i].deletedOn=new Date,r[i].firebaseMethod=f.f.DELETE,yield o.postAll(n,r),(yield o.getConnexionInfo()).isOnline&&(yield o.firestore.put(n,t.id.toString(),t))})()}deleteDefinitivement(n,t){var o=this;return(0,d.Z)(function*(){const r=yield o.getAll(n),i=yield o.getIndex(n,t.id);(yield o.getConnexionInfo()).isOnline?(r.splice(i,1),yield o.firestore.delete(n,t.id.toString(),t)):r[i].isFirebase?(r[i].firebaseMethod=f.f.DELETE,r[i].deletedOn=new Date):r.splice(i,1),yield o.postAll(n,r)})()}synchroniserAvecFirestore(){var n=this;return(0,d.Z)(function*(){(yield n.getConnexionInfo()).isOnline?(yield n.synchroniser(c.K.Utilisateurs),yield n.synchroniser(c.K.Articles),yield n.synchroniser(c.K.Courses),yield n.synchroniser(c.K.Familles),yield n.synchroniser(c.K.CourseDetails),yield n.synchroniser(c.K.Memos),yield n.synchroniser(c.K.HistoriquePrix),yield n.synchroniser(c.K.Depenses),yield n.synchroniser(c.K.Apports),yield n.synchroniser(c.K.Epargnes),yield n.synchroniser(c.K.Magasins),yield n.synchroniser(c.K.Plats),yield n.synchroniser(c.K.PlatDetails),yield n.synchroniser(c.K.Groupes),yield n.synchroniser(c.K.Menus),yield n.synchroniser(c.K.Budget)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(n){var t=this;return(0,d.Z)(function*(){if((yield t.getConnexionInfo()).isOnline){const r=yield t.storage.get(n),i=yield r.filter(l=>!l.isFirebase);i.length>0&&i.map(function(){var l=(0,d.Z)(function*(a){a.isFirebase=!0,yield t.firestore.post(n,a,a.id.toString())});return function(a){return l.apply(this,arguments)}}());const s=yield r.filter(l=>l.firebaseMethod===f.f.DELETE||l.firebaseMethod===f.f.PUT);s.length>0&&s.map(function(){var l=(0,d.Z)(function*(a){a.firebaseMethod===f.f.PUT&&(yield t.put(n,a)),a.firebaseMethod===f.f.DELETE&&(yield t.deleteDefinitivement(n,a))});return function(a){return l.apply(this,arguments)}}()),(yield t.firestore.getAll(n)).subscribe(l=>{t.storage.set(n,l)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(n,t){var o=this;return(0,d.Z)(function*(){yield o.storage.set(n,t)})()}getConnexionInfo(){var n=this;return(0,d.Z)(function*(){return yield n.storage.get(c.K.InfoConnexion)})()}}return(g=m).\u0275fac=function(n){return new(n||g)(v.LFG(h.K),v.LFG(C))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),m})()}}]);