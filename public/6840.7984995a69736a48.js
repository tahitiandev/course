"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6840],{6840:(b,v,u)=>{u.r(v),u.d(v,{SettingsPageModule:()=>n});var c=u(6814),d=u(95),g=u(7027),m=u(9801),h=u(5861),y=u(3009),e=u(6689),S=u(6815),C=u(5423),x=u(202);function P(t,s){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const l=e.oxw();e.xp6(1),e.hij("",l.magasinParDefaut," est actuellement le magasin par d\xe9faut")}}const Z=[{path:"",component:(()=>{var t;class s{constructor(i,o,r,a){this.alertController=i,this.utility=o,this.storage=r,this.magasinService=a,this.magasinParDefaut="",this.isOnline=!0,this.isCourseRapide=!0,this.montantBudget=1e4}ngOnInit(){var i=this;return(0,h.Z)(function*(){yield i.refresh()})()}refresh(){var i=this;return(0,h.Z)(function*(){var o;const r=yield i.utility.getConnexionInfo();i.connexionInfo=r,i.isOnline=r.isOnline,i.isCourseRapide=r.isCourseRapide,i.montantBudget=r.budget,i.magasinParDefaut=void 0===(null===(o=r.magasinParDefaut)||void 0===o?void 0:o.libelle)?"1":r.magasinParDefaut.libelle})()}setmagasinParDefaut(){var i=this;return(0,h.Z)(function*(){const o=yield i.magasinService.get(),r=[];var p;o.map(p=>{r.push({type:"radio",label:p.libelle,value:p,checked:i.magasinParDefaut===p.libelle})}),yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Magasin par d\xe9faut",inputs:r,buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(p=(0,h.Z)(function*(T){const I=yield i.utility.getConnexionInfo();I.magasinParDefaut=T,i.magasinParDefaut=T.libelle,yield i.storage.set(y.K.InfoConnexion,I)}),function(I){return p.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}synchroniser(){var i=this;return(0,h.Z)(function*(){yield i.storage.synchroniserAvecFirestore().then((0,h.Z)(function*(){yield i.utility.popUp("Synchronisation termin\xe9e")}))})()}setModeOnline(i){var o=this;return(0,h.Z)(function*(){const r=i.detail.checked,a=yield o.utility.getConnexionInfo();a.isOnline=r,yield o.utility.putConnexionInfo(a),yield o.refresh()})()}setModeCourseRapide(i){var o=this;return(0,h.Z)(function*(){const r=i.detail.checked,a=yield o.utility.getConnexionInfo();a.isCourseRapide=r,yield o.utility.putConnexionInfo(a),yield o.refresh()})()}consoleLog(i){var o=this;return(0,h.Z)(function*(){const r=yield o.storage.get(i);console.log(r)})()}updateBudget(){var i=this;return(0,h.Z)(function*(){const o=yield i.utility.getConnexionInfo();var a;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Magasin par d\xe9faut",inputs:[{type:"number",name:"budget",placeholder:o.budget.toString()}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(a=(0,h.Z)(function*(p){o.budget=""===p.budget?o.budget:p.budget,yield i.storage.set(y.K.InfoConnexion,o),yield i.refresh()}),function(T){return a.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(g.Br),e.Y36(S.t),e.Y36(C.V),e.Y36(x.t))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-settings"]],decls:86,vars:6,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["button","","detail","true",3,"click"],[3,"checked","ionChange"],[4,"ngIf"],["button","","detail","true","routerLink","/historique-prix"],["button","","detail","true","routerLink","/utilisateur-liste"],["button","","detail","true","routerLink","/utilisateur-groupes"]],template:function(i,o){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Param\xe8tres g\xe9n\xe9raux"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-item-group")(8,"ion-item-divider")(9,"ion-label"),e._uU(10,"Synchronisation"),e.qZA()(),e.TgZ(11,"ion-item",3),e.NdJ("click",function(){return o.synchroniser()}),e.TgZ(12,"ion-label")(13,"h3"),e._uU(14,"Synchroniser avec firebase"),e.qZA()()(),e.TgZ(15,"ion-item")(16,"ion-toggle",4),e.NdJ("ionChange",function(a){return o.setModeOnline(a)}),e._uU(17,"Mode Online"),e.qZA()()(),e.TgZ(18,"ion-item-group")(19,"ion-item-divider")(20,"ion-label"),e._uU(21,"G\xe9n\xe9ral"),e.qZA()(),e.TgZ(22,"ion-item",3),e.NdJ("click",function(){return o.setmagasinParDefaut()}),e.TgZ(23,"ion-label")(24,"h3"),e._uU(25,"Magasin par d\xe9faut"),e.qZA(),e.YNc(26,P,2,1,"p",5),e.qZA()(),e.TgZ(27,"ion-item")(28,"ion-toggle",4),e.NdJ("ionChange",function(a){return o.setModeCourseRapide(a)}),e._uU(29,"Mode course rapide"),e.qZA()()(),e.TgZ(30,"ion-item-group")(31,"ion-item-divider")(32,"ion-label"),e._uU(33,"Statistiques"),e.qZA()(),e.TgZ(34,"ion-item",6)(35,"ion-label")(36,"h3"),e._uU(37,"Historique des prix"),e.qZA()()(),e.TgZ(38,"ion-item",3),e.NdJ("click",function(){return o.updateBudget()}),e.TgZ(39,"ion-label")(40,"h3"),e._uU(41),e.qZA()()()(),e.TgZ(42,"ion-item-group")(43,"ion-item-divider")(44,"ion-label"),e._uU(45,"S\xe9curit\xe9"),e.qZA()(),e.TgZ(46,"ion-item",7)(47,"ion-label")(48,"h3"),e._uU(49,"Utilisateurs"),e.qZA()()(),e.TgZ(50,"ion-item",8)(51,"ion-label")(52,"h3"),e._uU(53,"Groupes"),e.qZA()()()(),e.TgZ(54,"ion-item-group")(55,"ion-item-divider")(56,"ion-label"),e._uU(57,"Console.log"),e.qZA()(),e.TgZ(58,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Courses")}),e.TgZ(59,"ion-label")(60,"h3"),e._uU(61,"Console.log : Course"),e.qZA()()(),e.TgZ(62,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("CourseDetails")}),e.TgZ(63,"ion-label")(64,"h3"),e._uU(65,"Console.log : CourseDetails"),e.qZA()()(),e.TgZ(66,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Utilisateurs")}),e.TgZ(67,"ion-label")(68,"h3"),e._uU(69,"Console.log : Utilisateurs"),e.qZA()()(),e.TgZ(70,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Groupes")}),e.TgZ(71,"ion-label")(72,"h3"),e._uU(73,"Console.log : Groupes"),e.qZA()()(),e.TgZ(74,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Articles")}),e.TgZ(75,"ion-label")(76,"h3"),e._uU(77,"Console.log : Articles"),e.qZA()()(),e.TgZ(78,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Magasins")}),e.TgZ(79,"ion-label")(80,"h3"),e._uU(81,"Console.log : Magasins"),e.qZA()()(),e.TgZ(82,"ion-item",3),e.NdJ("click",function(){return o.consoleLog("Plats")}),e.TgZ(83,"ion-label")(84,"h3"),e._uU(85,"Console.log : Plats"),e.qZA()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("checked",o.isOnline),e.xp6(10),e.Q6J("ngIf",""!==o.magasinParDefaut),e.xp6(2),e.Q6J("checked",o.isCourseRapide),e.xp6(13),e.hij("Budget du mois : ",o.montantBudget.toLocaleString()," XPF"))},dependencies:[c.O5,g.Sm,g.W2,g.Gu,g.Ie,g.rH,g.Ub,g.Q$,g.fG,g.wd,g.ho,g.sr,g.w,g.YI,m.rH]}),s})()}];let _=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(Z),m.Bz]}),s})(),n=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.ez,d.u5,g.Pc,_]}),s})()},9825:(b,v,u)=>{u.d(v,{f:()=>c});var c=function(d){return d.POST="POST",d.PUT="PUT",d.DELETE="DELETE",d}(c||{})},5423:(b,v,u)=>{u.d(v,{V:()=>P});var c=u(5861),d=u(3009),g=u(9825),m=u(6689),h=u(2014),y=u(2386),e=u(9392),S=u(3182),C=u(553);let x=(()=>{var f;class Z{constructor(n){this.firestore=n}post(n,t,s){return(0,c.Z)(function*(){const l=(0,S.ZF)(C.N.firebaseConfig),i=(0,e.ad)(l);yield(0,y.pl)((0,y.JU)(i,n,s),t)})()}getAll(n){var t=this;return(0,c.Z)(function*(){const s=yield(0,y.hJ)(t.firestore,n);return(0,y.BS)(s)})()}put(n,t,s){var l=this;return(0,c.Z)(function*(){const i=(0,y.JU)(l.firestore,n+"/"+t);return(0,y.r7)(i,s)})()}delete(n,t,s){var l=this;return(0,c.Z)(function*(){const i=(0,y.JU)(l.firestore,n+"/"+t);return(0,y.oe)(i)})()}}return(f=Z).\u0275fac=function(n){return new(n||f)(m.LFG(y.gg))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),Z})(),P=(()=>{var f;class Z{constructor(n,t){this.storage=n,this.firestore=t}postAll(n,t){var s=this;return(0,c.Z)(function*(){(yield s.getConnexionInfo()).isOnline&&(yield(yield t.filter(o=>!o.isFirebase)).map(function(){var o=(0,c.Z)(function*(r){r.isFirebase=!0,yield s.firestore.post(n,r,r.id.toString())});return function(r){return o.apply(this,arguments)}}())),yield s.storage.set(n,t)})()}post(n,t){var s=this;return(0,c.Z)(function*(){var l=yield s.getAll(n);t.id=Number(new Date),t.createdOn=new Date,t.modifiedOn=null,t.deletedOn=null,t.isFirebase=!1,l.push(t),yield s.postAll(n,l)})()}get(n){var t=this;return(0,c.Z)(function*(){return yield(yield t.storage.get(n)).filter(l=>""===l.deletedOn||null===l.deletedOn||void 0!==l.deletedOn)})()}getAll(n){var t=this;return(0,c.Z)(function*(){return yield t.storage.get(n)})()}getIndex(n,t){var s=this;return(0,c.Z)(function*(){return yield(yield s.getAll(n)).findIndex(i=>i.id===t)})()}put(n,t){var s=this;return(0,c.Z)(function*(){const l=yield s.getAll(n),i=yield s.getIndex(n,t.id);l[i]=t,l[i].modifiedOn=new Date,(yield s.getConnexionInfo()).isOnline?yield s.firestore.put(n,t.id.toString(),t):l[i].isFirebase&&(l[i].firebaseMethod=g.f.PUT),yield s.postAll(n,l)})()}delete(n,t){var s=this;return(0,c.Z)(function*(){const l=yield s.getAll(n),i=yield s.getIndex(n,t.id);l[i].deletedOn=new Date,l[i].firebaseMethod=g.f.DELETE,yield s.postAll(n,l),(yield s.getConnexionInfo()).isOnline&&(yield s.firestore.put(n,t.id.toString(),t))})()}deleteDefinitivement(n,t){var s=this;return(0,c.Z)(function*(){const l=yield s.getAll(n),i=yield s.getIndex(n,t.id);(yield s.getConnexionInfo()).isOnline?(l.splice(i,1),yield s.firestore.delete(n,t.id.toString(),t)):l[i].isFirebase?(l[i].firebaseMethod=g.f.DELETE,l[i].deletedOn=new Date):l.splice(i,1),yield s.postAll(n,l)})()}synchroniserAvecFirestore(){var n=this;return(0,c.Z)(function*(){(yield n.getConnexionInfo()).isOnline?(yield n.synchroniser(d.K.Utilisateurs),yield n.synchroniser(d.K.Articles),yield n.synchroniser(d.K.Courses),yield n.synchroniser(d.K.Familles),yield n.synchroniser(d.K.CourseDetails),yield n.synchroniser(d.K.Memos),yield n.synchroniser(d.K.HistoriquePrix),yield n.synchroniser(d.K.Depenses),yield n.synchroniser(d.K.Apports),yield n.synchroniser(d.K.Epargnes),yield n.synchroniser(d.K.Magasins),yield n.synchroniser(d.K.Plats),yield n.synchroniser(d.K.PlatDetails),yield n.synchroniser(d.K.Groupes),yield n.synchroniser(d.K.Menus)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(n){var t=this;return(0,c.Z)(function*(){if((yield t.getConnexionInfo()).isOnline){const l=yield t.storage.get(n),i=yield l.filter(r=>!r.isFirebase);i.length>0&&i.map(function(){var r=(0,c.Z)(function*(a){a.isFirebase=!0,yield t.firestore.post(n,a,a.id.toString())});return function(a){return r.apply(this,arguments)}}());const o=yield l.filter(r=>r.firebaseMethod===g.f.DELETE||r.firebaseMethod===g.f.PUT);o.length>0&&o.map(function(){var r=(0,c.Z)(function*(a){a.firebaseMethod===g.f.PUT&&(yield t.put(n,a)),a.firebaseMethod===g.f.DELETE&&(yield t.deleteDefinitivement(n,a))});return function(a){return r.apply(this,arguments)}}()),(yield t.firestore.getAll(n)).subscribe(r=>{t.storage.set(n,r)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(n,t){var s=this;return(0,c.Z)(function*(){yield s.storage.set(n,t)})()}getConnexionInfo(){var n=this;return(0,c.Z)(function*(){return yield n.storage.get(d.K.InfoConnexion)})()}}return(f=Z).\u0275fac=function(n){return new(n||f)(m.LFG(h.K),m.LFG(x))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),Z})()}}]);