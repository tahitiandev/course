"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1583],{9825:(U,v,d)=>{d.d(v,{f:()=>a});var a=function(c){return c.POST="POST",c.PUT="PUT",c.DELETE="DELETE",c}(a||{})},6:(U,v,d)=>{d.r(v),d.d(v,{UtilisateurListePageModule:()=>y});var a=d(6814),c=d(95),l=d(7027),m=d(9801),g=d(5861),i=d(6689),x=d(4073);function Z(o,h){if(1&o){const t=i.EpF();i.TgZ(0,"ion-item-sliding")(1,"ion-item",8),i.NdJ("click",function(){const s=i.CHM(t).$implicit,r=i.oxw();return i.KtG(r.put(s))}),i.TgZ(2,"ion-label")(3,"h3"),i._uU(4),i.qZA()()(),i.TgZ(5,"ion-item-options",9)(6,"ion-item-option",10),i.NdJ("click",function(){const s=i.CHM(t).$implicit,r=i.oxw();return i.KtG(r.deleteDefinitivement(s))}),i._uU(7," Supprimer "),i.qZA()()()}if(2&o){const t=h.$implicit;i.xp6(1),i.Q6J("disabled","DELETE"===t.firebaseMethod),i.xp6(3),i.Oqu(t.libelle)}}const b=[{path:"",component:(()=>{var o;class h{constructor(e,n){this.utilisteursService=e,this.alertController=n,this.utilisateurs=[]}ngOnInit(){this.refresh()}refresh(){var e=this;return(0,g.Z)(function*(){e.utilisateurs=yield e.getUtilisateurs()})()}getUtilisateurs(){var e=this;return(0,g.Z)(function*(){return(yield e.utilisteursService.get()).filter(n=>0!==n.id)})()}post(){var e=this;return(0,g.Z)(function*(){var s;yield(yield e.alertController.create({cssClass:"my-custom-class",header:"Cr\xe9er un utilisateur",inputs:[{type:"text",name:"libelle",placeholder:"Libell\xe9"},{type:"text",name:"username",placeholder:"login"},{type:"password",name:"password",placeholder:"Mot de passe"},{type:"email",name:"email",placeholder:"Email"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(s=(0,g.Z)(function*(r){var u={id:Number(new Date),libelle:r.libelle,username:r.username,password:r.password,email:r.email,groupeId:0,actif:!0,isFirebase:!1};yield e.utilisteursService.post(u),e.refresh()}),function(u){return s.apply(this,arguments)})}]})).present()})()}put(e){var n=this;return(0,g.Z)(function*(){var r;yield(yield n.alertController.create({cssClass:"my-custom-class",header:"Mise \xe0 jour de donn\xe9es utilisateur",inputs:[{type:"text",name:"libelle",placeholder:e.libelle},{type:"text",name:"username",placeholder:e.username},{type:"password",name:"password",placeholder:e.password},{type:"email",name:"email",placeholder:e.email}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(r=(0,g.Z)(function*(u){e.libelle=""===u.libelle?e.libelle:u.libelle,e.username=""===u.username?e.username:u.username,e.password=""===u.password?e.password:u.password,e.email=""===u.email?e.email:u.email,yield n.utilisteursService.put(e),n.refresh()}),function(f){return r.apply(this,arguments)})}]})).present()})()}deleteDefinitivement(e){var n=this;return(0,g.Z)(function*(){yield n.utilisteursService.deleteDefinitivement(e),yield n.refresh()})()}}return(o=h).\u0275fac=function(e){return new(e||o)(i.Y36(x.X),i.Y36(l.Br))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-utilisateur-liste"]],decls:12,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/settings"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["slot","fixed","horizontal","end","vertical","bottom"],["size","small",3,"click"],["name","add"],["button","","detail","true",3,"disabled","click"],["side","start"],[2,"background","red",3,"click"]],template:function(e,n){1&e&&(i.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),i._UZ(3,"ion-back-button",2),i.qZA(),i.TgZ(4,"ion-title"),i._uU(5,"Liste des utilisateurs"),i.qZA()()(),i.TgZ(6,"ion-content",3)(7,"ion-list"),i.YNc(8,Z,8,2,"ion-item-sliding",4),i.qZA(),i.TgZ(9,"ion-fab",5)(10,"ion-fab-button",6),i.NdJ("click",function(){return n.post()}),i._UZ(11,"ion-icon",7),i.qZA()()()),2&e&&(i.Q6J("translucent",!0),i.xp6(6),i.Q6J("fullscreen",!0),i.xp6(2),i.Q6J("ngForOf",n.utilisateurs))},dependencies:[a.sg,l.oU,l.Sm,l.W2,l.IJ,l.W4,l.Gu,l.gu,l.Ie,l.u8,l.IK,l.td,l.Q$,l.q_,l.wd,l.sr,l.cs]}),h})()}];let L=(()=>{var o;class h{}return(o=h).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[m.Bz.forChild(b),m.Bz]}),h})(),y=(()=>{var o;class h{}return(o=h).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[a.ez,c.u5,l.Pc,L]}),h})()},5423:(U,v,d)=>{d.d(v,{V:()=>L});var a=d(5861),c=d(3009),l=d(9825),m=d(6689),g=d(2014),i=d(2386),x=d(9392),Z=d(3182),I=d(553);let b=(()=>{var y;class o{constructor(t){this.firestore=t}post(t,e,n){return(0,a.Z)(function*(){const s=(0,Z.ZF)(I.N.firebaseConfig),r=(0,x.ad)(s);yield(0,i.pl)((0,i.JU)(r,t,n),e)})()}getAll(t){var e=this;return(0,a.Z)(function*(){const n=yield(0,i.hJ)(e.firestore,t);return(0,i.BS)(n)})()}put(t,e,n){var s=this;return(0,a.Z)(function*(){const r=(0,i.JU)(s.firestore,t+"/"+e);return(0,i.r7)(r,n)})()}delete(t,e,n){var s=this;return(0,a.Z)(function*(){const r=(0,i.JU)(s.firestore,t+"/"+e);return(0,i.oe)(r)})()}}return(y=o).\u0275fac=function(t){return new(t||y)(m.LFG(i.gg))},y.\u0275prov=m.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),o})(),L=(()=>{var y;class o{constructor(t,e){this.storage=t,this.firestore=e}postAll(t,e){var n=this;return(0,a.Z)(function*(){(yield n.getConnexionInfo()).isOnline&&(yield(yield e.filter(u=>!u.isFirebase)).map(function(){var u=(0,a.Z)(function*(f){f.isFirebase=!0,yield n.firestore.post(t,f,f.id.toString())});return function(f){return u.apply(this,arguments)}}())),yield n.storage.set(t,e)})()}parseDate(t){const n=new Date(t).getTime();return{nanoseconds:n%1e3*1e6,seconds:Math.floor(n/1e3)}}post(t,e){var n=this;return(0,a.Z)(function*(){var s=yield n.getAll(t);e.id=Number(new Date),e.createdOn=n.parseDate(new Date),e.modifiedOn=null,e.deletedOn=null,e.isFirebase=!1,s.push(e),yield n.postAll(t,s)})()}get(t){var e=this;return(0,a.Z)(function*(){return yield(yield e.storage.get(t)).filter(s=>""===s.deletedOn||null===s.deletedOn||void 0!==s.deletedOn)})()}getAll(t){var e=this;return(0,a.Z)(function*(){return yield e.storage.get(t)})()}getIndex(t,e){var n=this;return(0,a.Z)(function*(){return yield(yield n.getAll(t)).findIndex(r=>r.id===e)})()}put(t,e){var n=this;return(0,a.Z)(function*(){const s=yield n.getAll(t),r=yield n.getIndex(t,e.id);s[r]=e,s[r].modifiedOn=new Date,(yield n.getConnexionInfo()).isOnline?yield n.firestore.put(t,e.id.toString(),e):s[r].isFirebase&&(s[r].firebaseMethod=l.f.PUT),yield n.postAll(t,s)})()}delete(t,e){var n=this;return(0,a.Z)(function*(){const s=yield n.getAll(t),r=yield n.getIndex(t,e.id);s[r].deletedOn=new Date,s[r].firebaseMethod=l.f.DELETE,yield n.postAll(t,s),(yield n.getConnexionInfo()).isOnline&&(yield n.firestore.put(t,e.id.toString(),e))})()}deleteDefinitivement(t,e){var n=this;return(0,a.Z)(function*(){const s=yield n.getAll(t),r=yield n.getIndex(t,e.id);(yield n.getConnexionInfo()).isOnline?(s.splice(r,1),yield n.firestore.delete(t,e.id.toString(),e)):s[r].isFirebase?(s[r].firebaseMethod=l.f.DELETE,s[r].deletedOn=new Date):s.splice(r,1),yield n.postAll(t,s)})()}synchroniserAvecFirestore(){var t=this;return(0,a.Z)(function*(){(yield t.getConnexionInfo()).isOnline?(yield t.synchroniser(c.K.Utilisateurs),yield t.synchroniser(c.K.Articles),yield t.synchroniser(c.K.Courses),yield t.synchroniser(c.K.Familles),yield t.synchroniser(c.K.CourseDetails),yield t.synchroniser(c.K.Memos),yield t.synchroniser(c.K.HistoriquePrix),yield t.synchroniser(c.K.Depenses),yield t.synchroniser(c.K.Apports),yield t.synchroniser(c.K.Epargnes),yield t.synchroniser(c.K.Magasins),yield t.synchroniser(c.K.Plats),yield t.synchroniser(c.K.PlatDetails),yield t.synchroniser(c.K.Groupes),yield t.synchroniser(c.K.Menus),yield t.synchroniser(c.K.Budget)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(t){var e=this;return(0,a.Z)(function*(){if((yield e.getConnexionInfo()).isOnline){const s=yield e.storage.get(t),r=yield s.filter(f=>!f.isFirebase);r.length>0&&r.map(function(){var f=(0,a.Z)(function*(p){p.isFirebase=!0,yield e.firestore.post(t,p,p.id.toString())});return function(p){return f.apply(this,arguments)}}());const u=yield s.filter(f=>f.firebaseMethod===l.f.DELETE||f.firebaseMethod===l.f.PUT);u.length>0&&u.map(function(){var f=(0,a.Z)(function*(p){p.firebaseMethod===l.f.PUT&&(yield e.put(t,p)),p.firebaseMethod===l.f.DELETE&&(yield e.deleteDefinitivement(t,p))});return function(p){return f.apply(this,arguments)}}()),(yield e.firestore.getAll(t)).subscribe(f=>{e.storage.set(t,f)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(t,e){var n=this;return(0,a.Z)(function*(){yield n.storage.set(t,e)})()}getConnexionInfo(){var t=this;return(0,a.Z)(function*(){return yield t.storage.get(c.K.InfoConnexion)})()}}return(y=o).\u0275fac=function(t){return new(t||y)(m.LFG(g.K),m.LFG(b))},y.\u0275prov=m.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),o})()}}]);