"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6840],{6840:(C,v,a)=>{a.r(v),a.d(v,{SettingsPageModule:()=>t});var u=a(6814),d=a(95),c=a(7027),m=a(9801),y=a(5861),h=a(3009),e=a(6689),S=a(6815),P=a(5423),x=a(202);function A(n,o){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const s=e.oxw();e.xp6(1),e.hij("",s.magasinParDefaut," est actuellement le magasin par d\xe9faut")}}const p=[{path:"",component:(()=>{var n;class o{constructor(i,l,r,g){this.alertController=i,this.utility=l,this.storage=r,this.magasinService=g,this.magasinParDefaut="",this.isOnline=!0}ngOnInit(){var i=this;return(0,y.Z)(function*(){yield i.refresh()})()}refresh(){var i=this;return(0,y.Z)(function*(){var l;const r=yield i.utility.getConnexionInfo();i.connexionInfo=r,i.isOnline=r.isOnline,i.magasinParDefaut=void 0===(null===(l=r.magasinParDefaut)||void 0===l?void 0:l.libelle)?"1":r.magasinParDefaut.libelle})()}setmagasinParDefaut(){var i=this;return(0,y.Z)(function*(){const l=yield i.magasinService.get(),r=[];var Z;l.map(Z=>{r.push({type:"radio",label:Z.libelle,value:Z,checked:i.magasinParDefaut===Z.libelle})}),yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Magasin par d\xe9faut",inputs:r,buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(Z=(0,y.Z)(function*(I){const _=yield i.utility.getConnexionInfo();_.magasinParDefaut=I,i.magasinParDefaut=I.libelle,yield i.storage.set(h.K.InfoConnexion,_)}),function(_){return Z.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}synchroniser(){var i=this;return(0,y.Z)(function*(){yield i.storage.synchroniserAvecFirestore().then((0,y.Z)(function*(){yield i.utility.popUp("Synchronisation termin\xe9e")}))})()}setModeOnline(i){var l=this;return(0,y.Z)(function*(){const r=i.detail.checked,g=yield l.utility.getConnexionInfo();g.isOnline=r,yield l.utility.putConnexionInfo(g),yield l.refresh()})()}consoleLog(i){var l=this;return(0,y.Z)(function*(){const r=yield l.storage.get(i);console.log(r)})()}}return(n=o).\u0275fac=function(i){return new(i||n)(e.Y36(c.Br),e.Y36(S.t),e.Y36(P.V),e.Y36(x.t))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-settings"]],decls:79,vars:4,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["button","","detail","true",3,"click"],[3,"checked","ionChange"],[4,"ngIf"],["button","","detail","true","routerLink","/historique-prix"],["button","","detail","true","routerLink","/utilisateur-liste"],["button","","detail","true","routerLink","/utilisateur-groupes"]],template:function(i,l){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Param\xe8tres g\xe9n\xe9raux"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-item-group")(8,"ion-item-divider")(9,"ion-label"),e._uU(10,"Synchronisation"),e.qZA()(),e.TgZ(11,"ion-item",3),e.NdJ("click",function(){return l.synchroniser()}),e.TgZ(12,"ion-label")(13,"h3"),e._uU(14,"Synchroniser avec firebase"),e.qZA()()(),e.TgZ(15,"ion-item")(16,"ion-toggle",4),e.NdJ("ionChange",function(g){return l.setModeOnline(g)}),e._uU(17,"Mode Online"),e.qZA()()(),e.TgZ(18,"ion-item-group")(19,"ion-item-divider")(20,"ion-label"),e._uU(21,"G\xe9n\xe9ral"),e.qZA()(),e.TgZ(22,"ion-item",3),e.NdJ("click",function(){return l.setmagasinParDefaut()}),e.TgZ(23,"ion-label")(24,"h3"),e._uU(25,"Magasin par d\xe9faut"),e.qZA(),e.YNc(26,A,2,1,"p",5),e.qZA()()(),e.TgZ(27,"ion-item-group")(28,"ion-item-divider")(29,"ion-label"),e._uU(30,"Statistiques"),e.qZA()(),e.TgZ(31,"ion-item",6)(32,"ion-label")(33,"h3"),e._uU(34,"Historique des prix"),e.qZA()()()(),e.TgZ(35,"ion-item-group")(36,"ion-item-divider")(37,"ion-label"),e._uU(38,"S\xe9curit\xe9"),e.qZA()(),e.TgZ(39,"ion-item",7)(40,"ion-label")(41,"h3"),e._uU(42,"Utilisateurs"),e.qZA()()(),e.TgZ(43,"ion-item",8)(44,"ion-label")(45,"h3"),e._uU(46,"Groupes"),e.qZA()()()(),e.TgZ(47,"ion-item-group")(48,"ion-item-divider")(49,"ion-label"),e._uU(50,"Console.log"),e.qZA()(),e.TgZ(51,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Courses")}),e.TgZ(52,"ion-label")(53,"h3"),e._uU(54,"Console.log : Course"),e.qZA()()(),e.TgZ(55,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("CourseDetails")}),e.TgZ(56,"ion-label")(57,"h3"),e._uU(58,"Console.log : CourseDetails"),e.qZA()()(),e.TgZ(59,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Utilisateurs")}),e.TgZ(60,"ion-label")(61,"h3"),e._uU(62,"Console.log : Utilisateurs"),e.qZA()()(),e.TgZ(63,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Groupes")}),e.TgZ(64,"ion-label")(65,"h3"),e._uU(66,"Console.log : Groupes"),e.qZA()()(),e.TgZ(67,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Articles")}),e.TgZ(68,"ion-label")(69,"h3"),e._uU(70,"Console.log : Articles"),e.qZA()()(),e.TgZ(71,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Magasins")}),e.TgZ(72,"ion-label")(73,"h3"),e._uU(74,"Console.log : Magasins"),e.qZA()()(),e.TgZ(75,"ion-item",3),e.NdJ("click",function(){return l.consoleLog("Plats")}),e.TgZ(76,"ion-label")(77,"h3"),e._uU(78,"Console.log : Plats"),e.qZA()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("checked",l.isOnline),e.xp6(10),e.Q6J("ngIf",""!==l.magasinParDefaut))},dependencies:[u.O5,c.Sm,c.W2,c.Gu,c.Ie,c.rH,c.Ub,c.Q$,c.fG,c.wd,c.ho,c.sr,c.w,c.YI,m.rH]}),o})()}];let T=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.Bz.forChild(p),m.Bz]}),o})(),t=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,d.u5,c.Pc,T]}),o})()},9825:(C,v,a)=>{a.d(v,{f:()=>u});var u=function(d){return d.POST="POST",d.PUT="PUT",d.DELETE="DELETE",d}(u||{})},5423:(C,v,a)=>{a.d(v,{V:()=>A});var u=a(5861),d=a(3009),c=a(9825),m=a(6689),y=a(2014),h=a(2386),e=a(9392),S=a(3182),P=a(553);let x=(()=>{var f;class p{constructor(t){this.firestore=t}post(t,n,o){return(0,u.Z)(function*(){const s=(0,S.ZF)(P.N.firebaseConfig),i=(0,e.ad)(s);yield(0,h.pl)((0,h.JU)(i,t,o),n)})()}getAll(t){var n=this;return(0,u.Z)(function*(){const o=yield(0,h.hJ)(n.firestore,t);return(0,h.BS)(o)})()}put(t,n,o){var s=this;return(0,u.Z)(function*(){const i=(0,h.JU)(s.firestore,t+"/"+n);return(0,h.r7)(i,o)})()}delete(t,n,o){var s=this;return(0,u.Z)(function*(){const i=(0,h.JU)(s.firestore,t+"/"+n);return(0,h.oe)(i)})()}}return(f=p).\u0275fac=function(t){return new(t||f)(m.LFG(h.gg))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),p})(),A=(()=>{var f;class p{constructor(t,n){this.storage=t,this.firestore=n}postAll(t,n){var o=this;return(0,u.Z)(function*(){(yield o.getConnexionInfo()).isOnline&&(yield(yield n.filter(l=>!l.isFirebase)).map(function(){var l=(0,u.Z)(function*(r){r.isFirebase=!0,yield o.firestore.post(t,r,r.id.toString())});return function(r){return l.apply(this,arguments)}}())),yield o.storage.set(t,n)})()}post(t,n){var o=this;return(0,u.Z)(function*(){var s=yield o.getAll(t);n.id=Number(new Date),n.createdOn=new Date,n.modifiedOn=null,n.deletedOn=null,n.isFirebase=!1,s.push(n),yield o.postAll(t,s)})()}get(t){var n=this;return(0,u.Z)(function*(){return yield(yield n.storage.get(t)).filter(s=>""===s.deletedOn||null===s.deletedOn||void 0!==s.deletedOn)})()}getAll(t){var n=this;return(0,u.Z)(function*(){return yield n.storage.get(t)})()}getIndex(t,n){var o=this;return(0,u.Z)(function*(){return yield(yield o.getAll(t)).findIndex(i=>i.id===n)})()}put(t,n){var o=this;return(0,u.Z)(function*(){const s=yield o.getAll(t),i=yield o.getIndex(t,n.id);s[i]=n,s[i].modifiedOn=new Date,(yield o.getConnexionInfo()).isOnline?yield o.firestore.put(t,n.id.toString(),n):s[i].isFirebase&&(s[i].firebaseMethod=c.f.PUT),yield o.postAll(t,s)})()}delete(t,n){var o=this;return(0,u.Z)(function*(){const s=yield o.getAll(t),i=yield o.getIndex(t,n.id);s[i].deletedOn=new Date,s[i].firebaseMethod=c.f.DELETE,yield o.postAll(t,s),(yield o.getConnexionInfo()).isOnline&&(yield o.firestore.put(t,n.id.toString(),n))})()}deleteDefinitivement(t,n){var o=this;return(0,u.Z)(function*(){const s=yield o.getAll(t),i=yield o.getIndex(t,n.id);(yield o.getConnexionInfo()).isOnline?(s.splice(i,1),yield o.firestore.delete(t,n.id.toString(),n)):s[i].isFirebase?(s[i].firebaseMethod=c.f.DELETE,s[i].deletedOn=new Date):s.splice(i,1),yield o.postAll(t,s)})()}synchroniserAvecFirestore(){var t=this;return(0,u.Z)(function*(){(yield t.getConnexionInfo()).isOnline?(yield t.synchroniser(d.K.Utilisateurs),yield t.synchroniser(d.K.Articles),yield t.synchroniser(d.K.Courses),yield t.synchroniser(d.K.Familles),yield t.synchroniser(d.K.CourseDetails),yield t.synchroniser(d.K.Memos),yield t.synchroniser(d.K.HistoriquePrix),yield t.synchroniser(d.K.Depenses),yield t.synchroniser(d.K.Magasins),yield t.synchroniser(d.K.Plats),yield t.synchroniser(d.K.PlatDetails),yield t.synchroniser(d.K.Groupes),yield t.synchroniser(d.K.Menus)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(t){var n=this;return(0,u.Z)(function*(){if((yield n.getConnexionInfo()).isOnline){const s=yield n.storage.get(t),i=yield s.filter(r=>!r.isFirebase);i.length>0&&i.map(function(){var r=(0,u.Z)(function*(g){g.isFirebase=!0,yield n.firestore.post(t,g,g.id.toString())});return function(g){return r.apply(this,arguments)}}());const l=yield s.filter(r=>r.firebaseMethod===c.f.DELETE||r.firebaseMethod===c.f.PUT);l.length>0&&l.map(function(){var r=(0,u.Z)(function*(g){g.firebaseMethod===c.f.PUT&&(yield n.put(t,g)),g.firebaseMethod===c.f.DELETE&&(yield n.deleteDefinitivement(t,g))});return function(g){return r.apply(this,arguments)}}()),(yield n.firestore.getAll(t)).subscribe(r=>{n.storage.set(t,r)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(t,n){var o=this;return(0,u.Z)(function*(){yield o.storage.set(t,n)})()}getConnexionInfo(){var t=this;return(0,u.Z)(function*(){return yield t.storage.get(d.K.InfoConnexion)})()}}return(f=p).\u0275fac=function(t){return new(t||f)(m.LFG(y.K),m.LFG(x))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),p})()}}]);