"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4856],{4856:(b,A,u)=>{u.r(A),u.d(A,{PlatDetailsPageModule:()=>M});var h=u(6814),g=u(95),n=u(7027),P=u(9801),p=u(5861),t=u(6689),m=u(5512),x=u(6199),Z=u(6815),o=u(4956);let d=(()=>{var r;class c{transform(e,i){return e.filter(l=>l.libelle.toLowerCase().startsWith(i.toLowerCase()))}}return(r=c).\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.Yjl({name:"articleFiltrePlat",type:r,pure:!0}),c})();function y(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label"),t._uU(3),t.qZA()(),t.TgZ(4,"ion-item-options",4)(5,"ion-item-option",5),t.NdJ("click",function(){const s=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.selectArticle(s))}),t._uU(6,"Selectionner"),t.qZA()()()}if(2&r){const a=c.$implicit;t.xp6(3),t.AsE("",a.libelle," - ",a.prix[0].prix," xpf")}}let v=(()=>{var r;class c{constructor(e){this.articleService=e,this.searchValue="",this.articles=[],this.articlesOutput=new t.vpe}ngOnInit(){this.onInit()}onInit(){var e=this;return(0,p.Z)(function*(){const i=yield e.getArticles();e.articles=i})()}getArticles(){var e=this;return(0,p.Z)(function*(){return yield e.articleService.get()})()}selectArticle(e){this.articlesOutput.emit(e)}}return(r=c).\u0275fac=function(e){return new(e||r)(t.Y36(m.J))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-search-article-plat"]],outputs:{articlesOutput:"articlesOutput"},decls:10,vars:5,consts:[[2,"width","80%","margin","auto","margin-top","20px"],[3,"ngModel","ngModelChange"],[2,"margin","5%","width","100%","height","460px","overflow","scroll"],[4,"ngFor","ngForOf"],["side","end"],[3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-subtitle"),t._uU(3,"Rechercher d'article"),t.qZA()(),t.TgZ(4,"ion-card-content")(5,"ion-toolbar")(6,"ion-searchbar",1),t.NdJ("ngModelChange",function(l){return i.searchValue=l}),t.qZA()(),t.TgZ(7,"ion-list",2),t.YNc(8,y,7,2,"ion-item-sliding",3),t.ALo(9,"articleFiltrePlat"),t.qZA()()()),2&e&&(t.xp6(6),t.Q6J("ngModel",i.searchValue),t.xp6(2),t.Q6J("ngForOf",t.xi3(9,2,i.articles,i.searchValue)))},dependencies:[h.sg,g.JJ,g.On,n.PM,n.FN,n.Zi,n.tO,n.Ie,n.u8,n.IK,n.td,n.Q$,n.q_,n.VI,n.sr,n.j9,d]}),c})();function C(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"ion-content")(1,"app-search-article-plat",6),t.NdJ("articlesOutput",function(i){t.CHM(a);const s=t.oxw();return t.KtG(s.selectArticle(i))}),t.qZA(),t.TgZ(2,"ion-fab",7)(3,"ion-fab-button",8),t.NdJ("click",function(){t.CHM(a);const i=t.oxw();return t.KtG(i.setIsRechercheAvance())}),t._UZ(4,"ion-icon",9),t.qZA()()()}}function D(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"ion-item-sliding")(1,"ion-item",12),t.NdJ("click",function(){const s=t.CHM(a).$implicit,l=t.oxw(2);return t.KtG(l.put(s))}),t.TgZ(2,"ion-label")(3,"h3"),t._uU(4),t.qZA()()(),t.TgZ(5,"ion-item-options",13)(6,"ion-item-option",14),t.NdJ("click",function(){const s=t.CHM(a).$implicit,l=t.oxw(2);return t.KtG(l.retirer(s))}),t._uU(7," Retirer "),t.qZA()(),t.TgZ(8,"ion-item-options",15)(9,"ion-item-option",16),t.NdJ("click",function(){const s=t.CHM(a).$implicit,l=t.oxw(2);return t.KtG(l.sendToCourse(s))}),t._uU(10," Ajouter au panier "),t.qZA()()()}if(2&r){const a=c.$implicit;t.xp6(1),t.Q6J("disabled","DELETE"===a.firebaseMethod),t.xp6(3),t.AsE("",a.article.libelle," - ",a.total," XPF")}}function T(r,c){if(1&r){const a=t.EpF();t.TgZ(0,"ion-content",10),t._UZ(1,"br"),t.TgZ(2,"ion-list"),t.YNc(3,D,11,3,"ion-item-sliding",11),t.qZA(),t.TgZ(4,"ion-fab",7)(5,"ion-fab-button",8),t.NdJ("click",function(){t.CHM(a);const i=t.oxw();return t.KtG(i.post())}),t._UZ(6,"ion-icon",9),t.qZA()()()}if(2&r){const a=t.oxw();t.Q6J("fullscreen",!0),t.xp6(3),t.Q6J("ngForOf",a.platdetails)}}const I=[{path:"",component:(()=>{var r;class c{constructor(e,i,s,l,_,f){this.route=e,this.alertController=i,this.articleservice=s,this.courseservice=l,this.utility=_,this.platservice=f,this.platid=0,this.plat={id:0,libelle:"",total:0,createdOn:new Date,isFirebase:!1},this.platdetails=[],this.totalPlat=0,this.isRechercheAvancee=!1}ngOnInit(){var e=this;return(0,p.Z)(function*(){yield e.refresh()})()}selectArticle(e){var i=this;return(0,p.Z)(function*(){yield i.postQuantite(e),i.setIsRechercheAvance()})()}refresh(){var e=this;return(0,p.Z)(function*(){const i=yield e.route.snapshot.params.id;e.platid=i;var s=yield e.platservice.getPlatById(+i);e.plat=s;var l=yield e.platservice.getPlatDetails(+i);e.platdetails=l,e.calculeTotal()})()}setIsRechercheAvance(){this.isRechercheAvancee=!this.isRechercheAvancee}post(){var e=this;return(0,p.Z)(function*(){const i=[];var l;(yield e.articleservice.get()).map(l=>{i.push({type:"radio",value:l,label:l.libelle})}),yield(yield e.alertController.create({cssClass:"my-custom-class",header:"Cr\xe9er un plat",inputs:i,buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Recherche avanc\xe9e",cssClass:"secondary",handler:()=>{e.setIsRechercheAvance()}},{text:"Valider",handler:(l=(0,p.Z)(function*(_){yield e.postQuantite(_)}),function(f){return l.apply(this,arguments)})}]})).present()})()}postQuantite(e){var i=this;return(0,p.Z)(function*(){var l;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Cr\xe9er un plat",inputs:[{type:"number",name:"quantite",placeholder:"qt\xe9 1"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(l=(0,p.Z)(function*(_){var f=""===_.quantite?1:Number(_.quantite),O={id:0,ordre:Number(new Date),platId:Number(i.platid),article:e,quantite:f,total:e.prix[0].prix*f,isFirebase:!1};yield i.platservice.postPlatDetail(O),yield i.refresh()}),function(f){return l.apply(this,arguments)})}]})).present()})()}calculeTotal(){var e=this;return(0,p.Z)(function*(){const i=e.platdetails;var s=0;if(i.length>0)for(let l of i)s+=l.article.prix[0].prix*l.quantite;e.totalPlat=s,e.plat.total=s,yield e.platservice.put(e.plat)})()}put(e){var i=this;return(0,p.Z)(function*(){var l;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Cr\xe9er un plat",inputs:[{type:"number",name:"quantite",placeholder:"qt\xe9 : "+e.quantite}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(l=(0,p.Z)(function*(_){var f=Number(""===_.quantite?e.quantite:_.quantite);e.quantite=f,e.total=e.article.prix[0].prix*f,yield i.platservice.putPlatDetail(e),yield i.refresh()}),function(f){return l.apply(this,arguments)})}]})).present()})()}retirer(e){var i=this;return(0,p.Z)(function*(){yield i.platservice.deleteDefinitivementPlatDetail(e),yield i.refresh()})()}sendToCourse(e){var i=this;return(0,p.Z)(function*(){const s=yield i.courseservice.getCourseIsFocus(),l=e.article.prix.find(f=>f.magasin===s[0].magasinId),_={id:Number(new Date),ordre:0,courseId:s[0].id.toString(),libelle:e.article.libelle,quantite:e.quantite,articleId:e.article.id,prixArticle:void 0===l?e.article.prix[0].prix:l.prix,prixReel:void 0===l?e.article.prix[0].prix:l.prix,total:Number(e.quantite*(void 0===l?e.article.prix[0].prix:l.prix)),checked:!1,isFirebase:!1};yield i.courseservice.postCourseDetails(_),i.utility.popUp("Article ajout\xe9 au panier"),i.refresh()})()}}return(r=c).\u0275fac=function(e){return new(e||r)(t.Y36(P.gz),t.Y36(n.Br),t.Y36(m.J),t.Y36(x.N),t.Y36(Z.t),t.Y36(o.r))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-plat-details"]],decls:8,vars:5,consts:[[3,"translucent"],["slot","start"],["defaultHref","/plats"],[2,"text-align","center"],[4,"ngIf"],[3,"fullscreen",4,"ngIf"],[3,"articlesOutput"],["slot","fixed","horizontal","end","vertical","bottom"],["size","small",3,"click"],["name","add"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["button","","detail","true",3,"disabled","click"],["side","start"],[2,"background","red",3,"click"],["side","end"],[2,"background","rgb(0, 183, 255)",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5),t.qZA()()(),t.YNc(6,C,5,0,"ion-content",4),t.YNc(7,T,7,2,"ion-content",5)),2&e&&(t.Q6J("translucent",!0),t.xp6(5),t.AsE("",i.plat.libelle," - Total : ",i.plat.total," XPF"),t.xp6(1),t.Q6J("ngIf",i.isRechercheAvancee),t.xp6(1),t.Q6J("ngIf",!i.isRechercheAvancee))},dependencies:[h.sg,h.O5,n.oU,n.Sm,n.W2,n.IJ,n.W4,n.Gu,n.gu,n.Ie,n.u8,n.IK,n.td,n.Q$,n.q_,n.wd,n.sr,n.cs,v]}),c})()}];let F=(()=>{var r;class c{}return(r=c).\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[P.Bz.forChild(I),P.Bz]}),c})(),M=(()=>{var r;class c{}return(r=c).\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[h.ez,g.u5,n.Pc,F]}),c})()},5512:(b,A,u)=>{u.d(A,{J:()=>t});var h=u(5861),g=u(3009),n=u(6689),P=u(5423),p=u(6815);let t=(()=>{var m;class x{constructor(o,d){this.storage=o,this.utility=d}get(){var o=this;return(0,h.Z)(function*(){return o.orderByFamille(yield o.storage.get(g.K.Articles))})()}post(o){var d=this;return(0,h.Z)(function*(){yield d.storage.post(g.K.Articles,o)})()}put(o){var d=this;return(0,h.Z)(function*(){yield d.storage.put(g.K.Articles,o)})()}delete(o){var d=this;return(0,h.Z)(function*(){yield d.storage.delete(g.K.Articles,o)})()}deleteDefinitivement(o){var d=this;return(0,h.Z)(function*(){yield d.storage.deleteDefinitivement(g.K.Articles,o)})()}getArticleById(o){var d=this;return(0,h.Z)(function*(){return(yield d.get()).filter(v=>v.id==o)})()}getArticleByCodeBarre(o){var d=this;return(0,h.Z)(function*(){return(yield d.get()).filter(v=>v.codeBarre==o)})()}orderByFamille(o){return o.sort((d,y)=>d.familleId<y.familleId?-1:1)}}return(m=x).\u0275fac=function(o){return new(o||m)(n.LFG(P.V),n.LFG(p.t))},m.\u0275prov=n.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),x})()}}]);