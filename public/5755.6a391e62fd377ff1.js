"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5755],{5755:(W,A,f)=>{f.r(A),f.d(A,{CourseDetailsPageModule:()=>j});var g=f(6814),C=f(95),_=f(7027),b=f(9801),a=f(5861),e=f(6689),Z=f(6199),v=f(5512),I=f(6815),T=f(1934),q=f(4985),D=f(3629);let N=(()=>{var r;class u{transform(t,i){return t.filter(s=>s.libelle.toLowerCase().startsWith(i.toLowerCase()))}}return(r=u).\u0275fac=function(t){return new(t||r)},r.\u0275pipe=e.Yjl({name:"articleFiltre",type:r,pure:!0}),u})();function S(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-item-options",4)(5,"ion-item-option",5),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw();return e.KtG(s.selectArticle(o))}),e._uU(6,"Selectionner"),e.qZA()()()}if(2&r){const n=u.$implicit;e.xp6(3),e.AsE("",n.libelle," - ",n.prix[0].prix," xpf")}}let P=(()=>{var r;class u{constructor(t){this.articleService=t,this.searchValue="",this.articles=[],this.articlesOutput=new e.vpe}ngOnInit(){this.onInit()}onInit(){var t=this;return(0,a.Z)(function*(){const i=yield t.getArticles();t.articles=i})()}getArticles(){var t=this;return(0,a.Z)(function*(){return yield t.articleService.get()})()}selectArticle(t){this.articlesOutput.emit(t)}}return(r=u).\u0275fac=function(t){return new(t||r)(e.Y36(v.J))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-search-article"]],outputs:{articlesOutput:"articlesOutput"},decls:10,vars:5,consts:[[2,"width","80%","margin","auto","margin-top","20px"],[3,"ngModel","ngModelChange"],[2,"margin","5%","width","100%","height","460px","overflow","scroll"],[4,"ngFor","ngForOf"],["side","end"],[3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-subtitle"),e._uU(3,"Rechercher d'article"),e.qZA()(),e.TgZ(4,"ion-card-content")(5,"ion-toolbar")(6,"ion-searchbar",1),e.NdJ("ngModelChange",function(s){return i.searchValue=s}),e.qZA()(),e.TgZ(7,"ion-list",2),e.YNc(8,S,7,2,"ion-item-sliding",3),e.ALo(9,"articleFiltre"),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("ngModel",i.searchValue),e.xp6(2),e.Q6J("ngForOf",e.xi3(9,2,i.articles,i.searchValue)))},dependencies:[g.sg,C.JJ,C.On,_.PM,_.FN,_.Zi,_.tO,_.Ie,_.u8,_.IK,_.td,_.Q$,_.q_,_.VI,_.sr,_.j9,N]}),u})();function k(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-icon",6),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.setIsButtonActif())}),e.qZA()}}function J(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-content")(1,"app-search-article",7),e.NdJ("articlesOutput",function(i){e.CHM(n);const o=e.oxw();return e.KtG(o.selectArticle(i))}),e.qZA()()}}function w(r,u){1&r&&e._UZ(0,"ion-icon",23)}function M(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-item-option",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.associerUnCodeBarreAArticleSansTitre(i))}),e._uU(1," BarreCode "),e.qZA()}}function F(r,u){1&r&&e._UZ(0,"ion-icon",23)}const m=function(r){return{color:r}};function R(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item",15),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.put(o))}),e.TgZ(2,"ion-label",16),e._uU(3),e.qZA(),e.TgZ(4,"ion-label",16),e._uU(5),e.qZA(),e.TgZ(6,"ion-label",16),e._uU(7),e.qZA(),e.YNc(8,w,1,0,"ion-icon",17),e.qZA(),e.TgZ(9,"ion-item-options",18),e.YNc(10,M,2,0,"ion-item-option",19),e.TgZ(11,"ion-item-option",20),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.delete(o))}),e._uU(12," Supprimer "),e.qZA()(),e.TgZ(13,"ion-item-options",21)(14,"ion-item-option",22),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.check(o))}),e._uU(15," Check "),e.YNc(16,F,1,0,"ion-icon",17),e.qZA()()()}if(2&r){const n=u.$implicit;e.xp6(1),e.Q6J("disabled",n.checked||"DELETE"===n.firebaseMethod),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,m,n.checked?"brown":"white")),e.xp6(1),e.Oqu(n.libelle),e.xp6(1),e.Q6J("ngStyle",e.VKq(12,m,n.checked?"brown":"white")),e.xp6(1),e.hij("x ",n.quantite,""),e.xp6(1),e.Q6J("ngStyle",e.VKq(14,m,n.checked?"brown":"white")),e.xp6(1),e.hij("",n.total," xpf"),e.xp6(1),e.Q6J("ngIf",n.checked),e.xp6(2),e.Q6J("ngIf","Sans titre"===n.libelle),e.xp6(6),e.Q6J("ngIf",!n.checked)}}function B(r,u){if(1&r&&(e.TgZ(0,"ion-list"),e.YNc(1,R,17,16,"ion-item-sliding",14),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.coursedetails)}}function Q(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-fab",25)(1,"ion-fab-button",26),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.postArticleWithCalculator())}),e._UZ(2,"ion-icon",27),e.qZA(),e.TgZ(3,"ion-fab-button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.postArticleWithBarCode())}),e._UZ(4,"ion-icon",29),e.qZA(),e.TgZ(5,"ion-fab-button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.dechargerMemo())}),e._UZ(6,"ion-icon",30),e.qZA(),e.TgZ(7,"ion-fab-button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.postArticle())}),e._UZ(8,"ion-icon",31),e.qZA()()}}function U(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-fab",32),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.postArticleWithCalculator())}),e.TgZ(1,"ion-fab-button",33),e._UZ(2,"ion-icon",31),e.qZA()()}}function O(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-fab",34),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.setAfficherListe())}),e.TgZ(1,"ion-fab-button",35),e._UZ(2,"ion-icon",36),e.qZA()()}}function Y(r,u){1&r&&e._UZ(0,"ion-icon",23)}function K(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-item-option",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.associerUnCodeBarreAArticleSansTitre(i))}),e._uU(1," BarreCode "),e.qZA()}}function V(r,u){1&r&&e._UZ(0,"ion-icon",23)}function E(r,u){if(1&r){const n=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item",15),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.put(o))}),e.TgZ(2,"ion-label",16),e._uU(3),e.qZA(),e.TgZ(4,"ion-label",16),e._uU(5),e.qZA(),e.TgZ(6,"ion-label",16),e._uU(7),e.qZA(),e.YNc(8,Y,1,0,"ion-icon",17),e.qZA(),e.TgZ(9,"ion-item-options",18),e.YNc(10,K,2,0,"ion-item-option",19),e.TgZ(11,"ion-item-option",20),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.delete(o))}),e._uU(12," Supprimer "),e.qZA()(),e.TgZ(13,"ion-item-options",21)(14,"ion-item-option",22),e.NdJ("click",function(){const o=e.CHM(n).$implicit,s=e.oxw(3);return e.KtG(s.check(o))}),e._uU(15," Check "),e.YNc(16,V,1,0,"ion-icon",17),e.qZA()()()}if(2&r){const n=u.$implicit;e.xp6(1),e.Q6J("disabled",n.checked||"DELETE"===n.firebaseMethod),e.xp6(1),e.Q6J("ngStyle",e.VKq(10,m,n.checked?"brown":"white")),e.xp6(1),e.Oqu(n.libelle),e.xp6(1),e.Q6J("ngStyle",e.VKq(12,m,n.checked?"brown":"white")),e.xp6(1),e.hij("x ",n.quantite,""),e.xp6(1),e.Q6J("ngStyle",e.VKq(14,m,n.checked?"brown":"white")),e.xp6(1),e.hij("",n.total," xpf"),e.xp6(1),e.Q6J("ngIf",n.checked),e.xp6(2),e.Q6J("ngIf","Sans titre"===n.libelle),e.xp6(6),e.Q6J("ngIf",!n.checked)}}function G(r,u){if(1&r&&(e.TgZ(0,"ion-list"),e.YNc(1,E,17,16,"ion-item-sliding",14),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.coursedetails)}}function L(r,u){if(1&r&&(e.TgZ(0,"ion-content",8)(1,"div",9)(2,"ion-chip",10),e._uU(3),e.qZA()(),e.YNc(4,B,2,1,"ion-list",4),e.YNc(5,Q,9,0,"ion-fab",11),e.YNc(6,U,3,0,"ion-fab",12),e.YNc(7,O,3,0,"ion-fab",13),e.YNc(8,G,2,1,"ion-list",4),e.qZA()),2&r){const n=e.oxw();e.Udp("visibility",n.content_visibility),e.Q6J("fullscreen",!0),e.xp6(3),e.hij("",n.totalCourse," XPF"),e.xp6(1),e.Q6J("ngIf",!n.isModeCourseRapide),e.xp6(1),e.Q6J("ngIf",n.isButtonActif&&!n.isModeCourseRapide),e.xp6(1),e.Q6J("ngIf",n.isModeCourseRapide&&!n.isAfficherListe),e.xp6(1),e.Q6J("ngIf",n.isModeCourseRapide),e.xp6(1),e.Q6J("ngIf",n.isModeCourseRapide&&n.isAfficherListe)}}const z=[{path:"",component:(()=>{var r;class u{constructor(t,i,o,s,l,c,d,p,h){this.coursesService=t,this.alertController=i,this.articleservice=o,this.utility=s,this.codeBarre=l,this.articlesService=c,this.historiqueprixservice=d,this.memoservice=p,this.route=h,this.courseid=0,this.totalCourse=0,this.course={id:0,ordre:0,magasinId:1,montantTheorique:0,montantReel:0,ecart:0,date:new Date,actif:!0,isFirebase:!1},this.coursedetails=[],this.articles=[],this.content_visibility="",this.rechercheAvance=!1,this.isButtonActif=!0,this.isModeCourseRapide=!0,this.isAfficherListe=!1}ngOnInit(){this.refresh()}scanne(){var t=this;return(0,a.Z)(function*(){const i=yield t.codeBarre.STEP1EnableCameraReturnVisility();t.content_visibility=i;const o=yield t.codeBarre.STEP2ScanneBarCodeAndReturnContent(),s=yield t.codeBarre.STEP3disableCameraReturnVisility();return t.content_visibility=s,o})()}postArticleWithBarCode(){var t=this;return(0,a.Z)(function*(){const i=yield t.scanne(),o=yield t.articleservice.getArticleByCodeBarre(i);o.length>0?yield t.postPrix(o[0]):yield t.setArticleOnLocalStorageWithCodeBarre(i)})()}postArticleWithCalculator(){var t=this;return(0,a.Z)(function*(){var o;yield(yield t.alertController.create({cssClass:"my-custom-class",header:"Ajouter un \xe9lement au panier",inputs:[{type:"number",name:"prix",placeholder:"Prix"},{type:"number",name:"quantite",placeholder:"Quantit\xe9"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(o=(0,a.Z)(function*(s){var l=""==s.quantite?1:Number(s.quantite),c=""==s.prix?100:Number(s.prix),d={id:Date.now(),ordre:1,courseId:t.courseid,libelle:"Sans titre",quantite:l,articleId:0,prixArticle:c,prixReel:c,checked:!1,total:c*l,isFirebase:!1};yield t.coursesService.postCourseDetails(d),yield t.refresh(),t.isModeCourseRapide&&(t.isAfficherListe=!t.isAfficherListe)}),function(l){return o.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}associerUnCodeBarreAArticleSansTitre(t){var i=this;return(0,a.Z)(function*(){const o=yield i.scanne();yield i.setArticleArticleSanstitre(t,o)})()}setArticleArticleSanstitre(t,i){var o=this;return(0,a.Z)(function*(){var l;yield(yield o.alertController.create({cssClass:"my-custom-class",header:"Ajouter un \xe9lement au panier",inputs:[{type:"text",name:"libelle",placeholder:"Libelle"},{type:"number",name:"prix",placeholder:t.prixReel.toString()+" xpf"},{type:"number",name:"quantite",placeholder:"Qt\xe9: "+t.quantite.toString()}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(l=(0,a.Z)(function*(c){var d=""==c.quantite?1:Number(c.quantite),p=""==c.prix?100:Number(c.prix),h=""==c.libelle?"Prix":c.libelle,x={id:0,libelle:h,createdOn:new Date,groupeId:[0],familleId:0,codeBarre:i,isFirebase:!1,prix:[{magasin:o.course.magasinId,prix:p}]};yield o.articlesService.post(x);var y=yield o.articlesService.getArticleByCodeBarre(i);t.libelle=h,t.quantite=d,t.prixReel=p,t.articleId=null==y[0].id||null==y[0].id?0:y[0].id,t.total=p*d,yield o.coursesService.putCourseDetails(t),yield o.refresh()}),function(d){return l.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}setArticleOnLocalStorageWithCodeBarre(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"L'article n'existe pas, veuillez le cr\xe9\xe9",inputs:[{type:"text",name:"libelle",label:"Nom de l'article"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(s=(0,a.Z)(function*(l){l.codeBarre=yield t,yield i.postChoosePrixAndSaveArticle(l)}),function(c){return s.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}postChoosePrixAndSaveArticle(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Renseigner un prix",inputs:[{type:"number",name:"prix",placeholder:"PRIX"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(s=(0,a.Z)(function*(l){var c={id:Date.now(),libelle:t.libelle,prix:[{magasin:i.course.magasinId,prix:null==l?100:l.prix}],createdOn:new Date,groupeId:[(yield i.utility.getConnexionInfo()).groupeId],familleId:0,codeBarre:t.codeBarre,isFirebase:!1};yield i.articlesService.post(c),yield i.postPrix(c)}),function(c){return s.apply(this,arguments)})}]})).present().then(()=>{document.querySelector("ion-alert input").focus()})})()}refresh(){var t=this;return(0,a.Z)(function*(){t.courseid=t.getId();const i=yield t.getCourse();t.course=i;const o=yield t.getCourseDetail();t.coursedetails=o;const s=yield t.getArticles();t.articles=s,t.calculeTotalCourse()})()}calculeTotalCourse(){const t=this.coursedetails;var i=0;t.length>0?(t.map(o=>i+=o.total),this.totalCourse=i,this.course.montantReel=i,this.course.montantTheorique=i):(this.totalCourse=0,this.course.montantReel=0,this.course.montantTheorique=0),this.coursesService.putCourse(this.course)}getId(){return this.route.snapshot.params.id}getCourse(){var t=this;return(0,a.Z)(function*(){return yield t.coursesService.getCourseById(t.courseid)})()}getCourseDetail(){var t=this;return(0,a.Z)(function*(){return(yield t.coursesService.getCourseDetails(t.courseid)).filter(o=>null==o.deletedOn)})()}getArticles(){var t=this;return(0,a.Z)(function*(){return t.articleservice.get()})()}postArticle(){var t=this;return(0,a.Z)(function*(){const i=[];var s;t.articles.map(s=>i.push({type:"radio",label:s.libelle,value:s})),yield(yield t.alertController.create({cssClass:"my-custom-class",header:"Ajouter un \xe9l\xe9ment \xe0 votre panier ?",inputs:i,buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Nouvelle article",cssClass:"secondary",handler:(s=(0,a.Z)(function*(){yield t.postNouvelleArticle()}),function(){return s.apply(this,arguments)})},{text:"Recherche avanc\xe9e",cssClass:"secondary",handler:()=>{t.rechercheAvance=!t.rechercheAvance}},{text:"Valider",handler:function(){var s=(0,a.Z)(function*(l){yield t.postPrix(l)});return function(c){return s.apply(this,arguments)}}()}]})).present()})()}postNouvelleArticle(){var t=this;return(0,a.Z)(function*(){var o;yield(yield t.alertController.create({cssClass:"my-custom-class",header:"Ajouter un nouvelle article",inputs:[{type:"text",label:"Libell\xe9",name:"libelle"},{type:"number",placeholder:"Qt\xe9 : 1",name:"quantite"},{type:"number",placeholder:"Prix : 1000 xpf",name:"prix"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(o=(0,a.Z)(function*(s){var l=""===s.prix?1e3:Number(s.prix),c=""===s.quantite?1:Number(s.quantite),d={id:t.utility.generateId(),libelle:s.libelle,prix:[{magasin:t.course.magasinId,prix:l}],createdOn:new Date,groupeId:[(yield t.utility.getConnexionInfo()).groupeId],familleId:0,codeBarre:"",isFirebase:!1};yield t.articleservice.post(d);var p={id:Date.now(),ordre:1,courseId:t.courseid,libelle:d.libelle,quantite:c,articleId:d.id,prixArticle:d.prix[0].prix,prixReel:l,checked:!1,total:c*l,isFirebase:!1};yield t.coursesService.postCourseDetails(p),yield t.refresh()}),function(l){return o.apply(this,arguments)})}]})).present()})()}addNewPrixArticle(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Renseigner le prix et la quantit\xe9 souhait\xe9e",inputs:[{type:"number",placeholder:"Quantit\xe9 : 1",name:"quantite"},{type:"number",placeholder:"Prix ex: "+t.prix[0].prix+" xpf",name:"prix"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(s=(0,a.Z)(function*(l){t.prix.push({magasin:i.course.magasinId,prix:Number(""===l.prix?t.prix[0].prix:l.prix)}),yield i.articlesService.put(t);var c=Number(""===l.prix?t.prix[0].prix:l.prix),d=""===l.quantite?1:Number(l.quantite),p={id:Date.now(),ordre:1,courseId:i.courseid,libelle:t.libelle,quantite:d,articleId:t.id,prixArticle:c,prixReel:c,checked:!1,total:d*c,isFirebase:!1};yield i.coursesService.postCourseDetails(p),yield i.refresh()}),function(c){return s.apply(this,arguments)})}]})).present()})()}postPrix(t){var i=this;return(0,a.Z)(function*(){var o,c,s=yield null===(o=t.prix.find(l=>l.magasin==i.course.magasinId))||void 0===o?void 0:o.prix;void 0===s?yield i.addNewPrixArticle(t):yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Renseigner le prix et la quantit\xe9 souhait\xe9e",inputs:[{type:"number",placeholder:"Qt\xe9 : 1",name:"quantite"},{type:"number",placeholder:"Prix : "+s+" xpf",name:"prix"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(c=(0,a.Z)(function*(d){var p=""===d.prix?s:Number(d.prix),h=""===d.quantite?1:Number(d.quantite),x={id:Date.now(),ordre:1,courseId:i.courseid,libelle:t.libelle,quantite:h,articleId:t.id,prixArticle:Number(s),prixReel:Number(p),checked:!1,total:h*Number(p),isFirebase:!1};if(yield i.coursesService.postCourseDetails(x),x.prixReel!==x.prixArticle){const y=t.prix.findIndex($=>$.magasin===i.course.magasinId);t.prix[y].prix=Number(x.prixReel),yield i.putPrixFicheArticle(t,Number(s))}else yield i.refresh()}),function(p){return c.apply(this,arguments)})}]})).present()})()}putPrixFicheArticle(t,i){var o=this;return(0,a.Z)(function*(){var l;yield(yield o.alertController.create({cssClass:"my-custom-class",header:"Le prix renseign\xe9 est diff\xe9r\xe9 du prix de la fiche article. Souhaitez-vous le mettre \xe0 jour ?",inputs:[],buttons:[{text:"Non",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Oui",handler:(l=(0,a.Z)(function*(){yield o.articlesService.put(t);const c=t.prix.findIndex(p=>p.magasin===o.course.magasinId),d={id:Number(new Date),articleId:t.id,libelle:t.libelle,prixAncien:i,prixNouveau:t.prix[c].prix,magasinid:t.prix[c].magasin,date:new Date,isFirebase:!1};yield o.historiqueprixservice.post(d),o.refresh()}),function(){return l.apply(this,arguments)})}]})).present()})()}check(t){var i=this;return(0,a.Z)(function*(){t.checked=!t.checked,yield i.coursesService.putCourseDetails(t),yield i.refresh()})()}put(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Renseigner le prix et la quantit\xe9 souhait\xe9e",inputs:[{type:"text",value:t.libelle,label:"Libell\xe9",name:"libelle"},{type:"number",value:t.quantite,label:"Quantit\xe9",name:"quantite"},{type:"number",label:"Prix",name:"prix",value:t.prixReel}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(s=(0,a.Z)(function*(l){if(t.libelle=l.libelle,t.prixReel=l.prix,t.quantite=l.quantite,t.total=l.prix*l.quantite,yield i.coursesService.putCourseDetails(t),l.prix==t.prixArticle)yield i.refresh();else if("Sans titre"!==t.libelle){const c=yield i.articlesService.getArticleById(t.articleId),d=yield c[0].prix.findIndex(p=>p.magasin===i.course.magasinId);i.putArticleOnDatabase({articleId:t.articleId,prixNouveau:Number(l.prix),prixAncien:Number(c[0].prix[d].prix),magasinId:i.course.magasinId,coursedetail:t})}}),function(c){return s.apply(this,arguments)})}]})).present()})()}putArticleOnDatabase(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Souhaitez-vous \xe9galement mettre \xe0 jour le prix en base de donn\xe9es ?",buttons:[{text:"Annuler",role:"Non",cssClass:"secondary",handler:()=>{}},{text:"Oui",handler:(s=(0,a.Z)(function*(){var l=yield i.articleservice.getArticleById(Number(t.articleId)),c=yield l[0].prix.findIndex(h=>h.magasin==t.magasinId);l[0].prix[c].prix=t.prixNouveau,yield i.articleservice.put(l[0]),t.coursedetail.prixArticle=t.prixNouveau,yield i.coursesService.putCourseDetails(t.coursedetail);const p={id:Number(new Date),articleId:l[0].id,libelle:l[0].libelle,prixAncien:t.prixAncien,prixNouveau:t.prixNouveau,magasinid:i.course.magasinId,date:new Date,isFirebase:!1};yield i.historiqueprixservice.post(p),yield i.refresh()}),function(){return s.apply(this,arguments)})}]})).present()})()}selectArticle(t){var i=this;return(0,a.Z)(function*(){yield i.postPrix(t),i.rechercheAvance=!i.rechercheAvance})()}delete(t){var i=this;return(0,a.Z)(function*(){var s;yield(yield i.alertController.create({cssClass:"my-custom-class",header:"Souhaitez-vous r\xe9ellement retirer l'article de votre liste ?",buttons:[{text:"Annuler",role:"Non",cssClass:"secondary",handler:()=>{}},{text:"Oui",handler:(s=(0,a.Z)(function*(){yield i.coursesService.deleteDefinitivementCourseDetails(t),yield i.refresh()}),function(){return s.apply(this,arguments)})}]})).present()})()}deleteCourseDetail(t){var i=this;return(0,a.Z)(function*(){yield i.coursesService.deleteCourseDetails(t),yield i.refresh()})()}setIsButtonActif(){this.isButtonActif=!this.isButtonActif}dechargerMemo(){var t=this;return(0,a.Z)(function*(){var o;yield(yield t.alertController.create({cssClass:"my-custom-class",header:"Souhaitez-vous d\xe9charger vos notes de course ?",buttons:[{text:"Annuler",role:"Non",cssClass:"secondary",handler:()=>{}},{text:"Oui",handler:(o=(0,a.Z)(function*(){const s=yield t.memoservice.get();for(let c of s){const d=c.article.prix.find(p=>p.magasin===t.course.magasinId);var l={id:Number(new Date),ordre:0,courseId:t.course.id.toString(),libelle:c.article.libelle,quantite:c.quantite,articleId:c.article.id,prixArticle:void 0===d?c.article.prix[0].prix:d.prix,prixReel:void 0===d?c.article.prix[0].prix:d.prix,total:Number(c.quantite*(void 0===d?c.article.prix[0].prix:d.prix)),checked:!1,isFirebase:!1};yield t.coursesService.postCourseDetails(l),yield t.memoservice.delete(c)}yield t.refresh()}),function(){return o.apply(this,arguments)})}]})).present()})()}setAfficherListe(){this.isAfficherListe=!this.isAfficherListe}}return(r=u).\u0275fac=function(t){return new(t||r)(e.Y36(Z.N),e.Y36(_.Br),e.Y36(v.J),e.Y36(I.t),e.Y36(T.k),e.Y36(v.J),e.Y36(q.a),e.Y36(D.T),e.Y36(b.gz))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-course-details"]],decls:9,vars:4,consts:[[3,"translucent"],["slot","start"],["defaultHref","/courses"],["style","margin-left: 50px;","name","apps-outline",3,"click",4,"ngIf"],[4,"ngIf"],[3,"fullscreen","visibility",4,"ngIf"],["name","apps-outline",2,"margin-left","50px",3,"click"],[3,"articlesOutput"],[3,"fullscreen"],[2,"display","flex","justify-content","center","padding","10px"],["color","white",2,"font-weight","bold","font-size","x-large"],["slot","fixed","horizontal","end","vertical","bottom",4,"ngIf"],["slot","fixed","horizontal","center","vertical","center",3,"click",4,"ngIf"],["slot","fixed","horizontal","end","vertical","bottom",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["button","",3,"disabled","click"],[3,"ngStyle"],["name","lock-closed-outline",4,"ngIf"],["side","start"],["style","color: rgb(255, 196, 216); background: rgb(39, 24, 102);",3,"click",4,"ngIf"],[2,"background","red",3,"click"],["side","end"],[3,"click"],["name","lock-closed-outline"],[2,"color","rgb(255, 196, 216)","background","rgb(39, 24, 102)",3,"click"],["slot","fixed","horizontal","end","vertical","bottom"],["size","large","color","success",3,"click"],["name","calculator-outline"],["size","small",3,"click"],["name","barcode"],["name","book-outline"],["name","add"],["slot","fixed","horizontal","center","vertical","center",3,"click"],["size","large"],["slot","fixed","horizontal","end","vertical","bottom",3,"click"],["size","small"],["name","list-circle-outline"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5," Votre liste de course "),e.YNc(6,k,1,0,"ion-icon",3),e.qZA()()(),e.YNc(7,J,2,0,"ion-content",4),e.YNc(8,L,9,9,"ion-content",5)),2&t&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("ngIf",!i.isModeCourseRapide),e.xp6(1),e.Q6J("ngIf",i.rechercheAvance),e.xp6(1),e.Q6J("ngIf",!i.rechercheAvance))},dependencies:[g.sg,g.O5,g.PC,_.oU,_.Sm,_.hM,_.W2,_.IJ,_.W4,_.Gu,_.gu,_.Ie,_.u8,_.IK,_.td,_.Q$,_.q_,_.wd,_.sr,_.cs,P]}),u})()}];let H=(()=>{var r;class u{}return(r=u).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[b.Bz.forChild(z),b.Bz]}),u})(),j=(()=>{var r;class u{}return(r=u).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[g.ez,C.u5,_.Pc,H]}),u})()}}]);