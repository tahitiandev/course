"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1005],{1005:(C,p,l)=>{l.r(p),l.d(p,{BudgetsPageModule:()=>t});var u=l(6814),c=l(95),a=l(7027),h=l(9801),y=l(5861),r=l(6689),Z=l(6815),m=l(3009),I=l(5423);let B=(()=>{var e;class i{constructor(n){this.storage=n}get(){var n=this;return(0,y.Z)(function*(){return yield n.storage.get(m.K.Budget)})()}getByMois(n){var o=this;return(0,y.Z)(function*(){var d=yield o.get();return yield d.find(f=>f.mois===n)})()}post(n){var o=this;return(0,y.Z)(function*(){yield o.storage.post(m.K.Budget,n)})()}delete(n){var o=this;return(0,y.Z)(function*(){yield o.storage.deleteDefinitivement(m.K.Budget,n)})()}put(n){var o=this;return(0,y.Z)(function*(){yield o.storage.put(m.K.Budget,n)})()}}return(e=i).\u0275fac=function(n){return new(n||e)(r.LFG(I.V))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),i})();function F(e,i){if(1&e){const s=r.EpF();r.TgZ(0,"ion-item"),r._UZ(1,"ion-icon",6),r.TgZ(2,"ion-label",7),r.NdJ("click",function(){const d=r.CHM(s).$implicit,f=r.oxw();return r.KtG(f.put(d.mois))}),r._uU(3),r.qZA()()}if(2&e){const s=i.$implicit;r.xp6(3),r.AsE("",s.mois," : ",s.budget," XPF")}}const v=[{path:"",component:(()=>{var e;class i{constructor(n,o,d){this.alertController=n,this.utility=o,this.budgetsservice=d,this.budgets=[]}ngOnInit(){this.refresh()}refresh(){var n=this;return(0,y.Z)(function*(){const o=yield n.get();n.budgets=o})()}get(){var n=this;return(0,y.Z)(function*(){return yield n.budgetsservice.get()})()}post(){var n=this;return(0,y.Z)(function*(){var d;yield(yield n.alertController.create({cssClass:"my-custom-class",header:"Faite une epargne",inputs:[{type:"text",name:"mois",placeholder:"Mois"},{type:"number",name:"budget",placeholder:"Budget"}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(d=(0,y.Z)(function*(f){const b={id:0,mois:f.mois,budget:f.budget,isFirebase:!1};yield n.budgetsservice.post(b),yield n.refresh()}),function(b){return d.apply(this,arguments)})}]})).present()})()}put(n){var o=this;return(0,y.Z)(function*(){var b,d=yield o.budgetsservice.getByMois(n);yield(yield o.alertController.create({cssClass:"my-custom-class",header:"Modifier le budget de "+d.mois,inputs:[{type:"number",name:"budget",placeholder:d.budget.toString()}],buttons:[{text:"Annuler",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Valider",handler:(b=(0,y.Z)(function*(P){d.budget=""===P.budget?d.budget:P.budget,yield o.budgetsservice.put(d),yield o.refresh();const A=yield o.utility.getConnexionInfo();A.budget=d.budget,yield o.utility.putConnexionInfo(A)}),function(A){return b.apply(this,arguments)})}]})).present()})()}}return(e=i).\u0275fac=function(n){return new(n||e)(r.Y36(a.Br),r.Y36(Z.t),r.Y36(B))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-budgets"]],decls:9,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/settings"],[3,"fullscreen"],[2,"margin","15px"],[4,"ngFor","ngForOf"],["aria-hidden","true","name","calendar","slot","start"],[2,"cursor","pointer",3,"click"]],template:function(n,o){1&n&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),r._UZ(3,"ion-back-button",2),r.qZA(),r.TgZ(4,"ion-title"),r._uU(5,"Budget fix\xe9 par mois"),r.qZA()()(),r.TgZ(6,"ion-content",3)(7,"ion-list",4),r.YNc(8,F,4,2,"ion-item",5),r.qZA()()),2&n&&(r.Q6J("translucent",!0),r.xp6(6),r.Q6J("fullscreen",!0),r.xp6(2),r.Q6J("ngForOf",o.budgets))},dependencies:[u.sg,a.oU,a.Sm,a.W2,a.Gu,a.gu,a.Ie,a.Q$,a.q_,a.wd,a.sr,a.cs]}),i})()}];let x=(()=>{var e;class i{}return(e=i).\u0275fac=function(n){return new(n||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[h.Bz.forChild(v),h.Bz]}),i})(),t=(()=>{var e;class i{}return(e=i).\u0275fac=function(n){return new(n||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[u.ez,c.u5,a.Pc,x]}),i})()},9825:(C,p,l)=>{l.d(p,{f:()=>u});var u=function(c){return c.POST="POST",c.PUT="PUT",c.DELETE="DELETE",c}(u||{})},5423:(C,p,l)=>{l.d(p,{V:()=>F});var u=l(5861),c=l(3009),a=l(9825),h=l(6689),y=l(2014),r=l(2386),Z=l(9392),m=l(3182),I=l(553);let B=(()=>{var g;class v{constructor(t){this.firestore=t}post(t,e,i){return(0,u.Z)(function*(){const s=(0,m.ZF)(I.N.firebaseConfig),n=(0,Z.ad)(s);yield(0,r.pl)((0,r.JU)(n,t,i),e)})()}getAll(t){var e=this;return(0,u.Z)(function*(){const i=yield(0,r.hJ)(e.firestore,t);return(0,r.BS)(i)})()}put(t,e,i){var s=this;return(0,u.Z)(function*(){const n=(0,r.JU)(s.firestore,t+"/"+e);return(0,r.r7)(n,i)})()}delete(t,e,i){var s=this;return(0,u.Z)(function*(){const n=(0,r.JU)(s.firestore,t+"/"+e);return(0,r.oe)(n)})()}}return(g=v).\u0275fac=function(t){return new(t||g)(h.LFG(r.gg))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),v})(),F=(()=>{var g;class v{constructor(t,e){this.storage=t,this.firestore=e}postAll(t,e){var i=this;return(0,u.Z)(function*(){(yield i.getConnexionInfo()).isOnline&&(yield(yield e.filter(o=>!o.isFirebase)).map(function(){var o=(0,u.Z)(function*(d){d.isFirebase=!0,yield i.firestore.post(t,d,d.id.toString())});return function(d){return o.apply(this,arguments)}}())),yield i.storage.set(t,e)})()}parseDate(t){const i=new Date(t).getTime();return{nanoseconds:i%1e3*1e6,seconds:Math.floor(i/1e3)}}post(t,e){var i=this;return(0,u.Z)(function*(){var s=yield i.getAll(t);e.id=Number(new Date),e.createdOn=i.parseDate(new Date),e.modifiedOn=null,e.deletedOn=null,e.isFirebase=!1,s.push(e),yield i.postAll(t,s)})()}get(t){var e=this;return(0,u.Z)(function*(){return yield(yield e.storage.get(t)).filter(s=>""===s.deletedOn||null===s.deletedOn||void 0!==s.deletedOn)})()}getAll(t){var e=this;return(0,u.Z)(function*(){return yield e.storage.get(t)})()}getIndex(t,e){var i=this;return(0,u.Z)(function*(){return yield(yield i.getAll(t)).findIndex(n=>n.id===e)})()}put(t,e){var i=this;return(0,u.Z)(function*(){const s=yield i.getAll(t),n=yield i.getIndex(t,e.id);s[n]=e,s[n].modifiedOn=new Date,(yield i.getConnexionInfo()).isOnline?yield i.firestore.put(t,e.id.toString(),e):s[n].isFirebase&&(s[n].firebaseMethod=a.f.PUT),yield i.postAll(t,s)})()}delete(t,e){var i=this;return(0,u.Z)(function*(){const s=yield i.getAll(t),n=yield i.getIndex(t,e.id);s[n].deletedOn=new Date,s[n].firebaseMethod=a.f.DELETE,yield i.postAll(t,s),(yield i.getConnexionInfo()).isOnline&&(yield i.firestore.put(t,e.id.toString(),e))})()}deleteDefinitivement(t,e){var i=this;return(0,u.Z)(function*(){const s=yield i.getAll(t),n=yield i.getIndex(t,e.id);(yield i.getConnexionInfo()).isOnline?(s.splice(n,1),yield i.firestore.delete(t,e.id.toString(),e)):s[n].isFirebase?(s[n].firebaseMethod=a.f.DELETE,s[n].deletedOn=new Date):s.splice(n,1),yield i.postAll(t,s)})()}synchroniserAvecFirestore(){var t=this;return(0,u.Z)(function*(){(yield t.getConnexionInfo()).isOnline?(yield t.synchroniser(c.K.Utilisateurs),yield t.synchroniser(c.K.Articles),yield t.synchroniser(c.K.Courses),yield t.synchroniser(c.K.Familles),yield t.synchroniser(c.K.CourseDetails),yield t.synchroniser(c.K.Memos),yield t.synchroniser(c.K.HistoriquePrix),yield t.synchroniser(c.K.Depenses),yield t.synchroniser(c.K.Apports),yield t.synchroniser(c.K.Epargnes),yield t.synchroniser(c.K.Magasins),yield t.synchroniser(c.K.Plats),yield t.synchroniser(c.K.PlatDetails),yield t.synchroniser(c.K.Groupes),yield t.synchroniser(c.K.Menus),yield t.synchroniser(c.K.Budget)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(t){var e=this;return(0,u.Z)(function*(){if((yield e.getConnexionInfo()).isOnline){const s=yield e.storage.get(t),n=yield s.filter(d=>!d.isFirebase);n.length>0&&n.map(function(){var d=(0,u.Z)(function*(f){f.isFirebase=!0,yield e.firestore.post(t,f,f.id.toString())});return function(f){return d.apply(this,arguments)}}());const o=yield s.filter(d=>d.firebaseMethod===a.f.DELETE||d.firebaseMethod===a.f.PUT);o.length>0&&o.map(function(){var d=(0,u.Z)(function*(f){f.firebaseMethod===a.f.PUT&&(yield e.put(t,f)),f.firebaseMethod===a.f.DELETE&&(yield e.deleteDefinitivement(t,f))});return function(f){return d.apply(this,arguments)}}()),(yield e.firestore.getAll(t)).subscribe(d=>{e.storage.set(t,d)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(t,e){var i=this;return(0,u.Z)(function*(){yield i.storage.set(t,e)})()}getConnexionInfo(){var t=this;return(0,u.Z)(function*(){return yield t.storage.get(c.K.InfoConnexion)})()}}return(g=v).\u0275fac=function(t){return new(t||g)(h.LFG(y.K),h.LFG(B))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),v})()}}]);