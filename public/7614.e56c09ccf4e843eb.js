"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7614],{3252:(A,p,a)=>{a.r(p),a.d(p,{HistoriquePrixPageModule:()=>s});var d=a(6814),c=a(95),f=a(7027),h=a(9801),x=a(5861),i=a(6689),m=a(4985),P=a(202);function _(n,o){1&n&&i._UZ(0,"ion-icon",13)}function Z(n,o){1&n&&i._UZ(0,"ion-icon",14)}function I(n,o){if(1&n){const l=i.EpF();i.TgZ(0,"div")(1,"ion-item",8),i.YNc(2,_,1,0,"ion-icon",9),i.YNc(3,Z,1,0,"ion-icon",10),i._uU(4),i._UZ(5,"br"),i._uU(6),i.qZA(),i.TgZ(7,"ion-item-options",11)(8,"ion-item-option",12),i.NdJ("click",function(){i.CHM(l);const u=i.oxw().$implicit,T=i.oxw(2);return i.KtG(T.deleteDefinitivement(u))}),i._uU(9," Supprimer "),i.qZA()()()}if(2&n){const l=i.oxw().$implicit;i.xp6(1),i.Q6J("disabled","DELETE"===l.firebaseMethod),i.xp6(1),i.Q6J("ngIf",l.prixAncien<l.prixNouveau),i.xp6(1),i.Q6J("ngIf",l.prixAncien>l.prixNouveau),i.xp6(1),i.hij(" ",l.libelle,""),i.xp6(2),i.AsE(" ",l.prixAncien," XPF > ",l.prixNouveau," XPF ")}}function g(n,o){if(1&n&&(i.TgZ(0,"ion-item-sliding"),i.YNc(1,I,10,6,"div",7),i.qZA()),2&n){const l=o.$implicit,r=i.oxw().$implicit;i.xp6(1),i.Q6J("ngIf",l.magasinid===r.id)}}function y(n,o){if(1&n&&(i.TgZ(0,"ion-list")(1,"ion-item"),i._UZ(2,"ion-icon",5),i.TgZ(3,"ion-label",6),i._uU(4),i.qZA()(),i.TgZ(5,"ion-list"),i.YNc(6,g,2,1,"ion-item-sliding",4),i.qZA()()),2&n){const l=o.$implicit,r=i.oxw();i.xp6(4),i.Oqu(l.libelle),i.xp6(2),i.Q6J("ngForOf",r.historiqueprix)}}const e=[{path:"",component:(()=>{var n;class o{constructor(r,u){this.historiqueprixservice=r,this.magasinservice=u,this.historiqueprix=[],this.magasins=[]}ngOnInit(){var r=this;return(0,x.Z)(function*(){yield r.refresh()})()}refresh(){var r=this;return(0,x.Z)(function*(){r.historiqueprix=yield r.historiqueprixservice.get(),r.magasins=yield r.getMagasin()})()}getMagasin(){var r=this;return(0,x.Z)(function*(){return yield r.magasinservice.get()})()}getLibelleMagasin(r){var u;return null===(u=this.magasins.find(T=>T.id==r))||void 0===u?void 0:u.libelle}deleteDefinitivement(r){var u=this;return(0,x.Z)(function*(){yield u.historiqueprixservice.deleteDefinitivement(r),yield u.refresh()})()}}return(n=o).\u0275fac=function(r){return new(r||n)(i.Y36(m.a),i.Y36(P.t))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-historique-prix"]],decls:8,vars:3,consts:[[3,"translucent"],["slot","start"],["defaultHref","/settings"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["name","storefront-outline"],[2,"margin-left","10px"],[4,"ngIf"],["button","",3,"disabled"],["style","margin-right: 10px;","name","trending-up-outline",4,"ngIf"],["style","margin-right: 10px;","name","trending-down-outline",4,"ngIf"],["side","start"],[2,"background","red",3,"click"],["name","trending-up-outline",2,"margin-right","10px"],["name","trending-down-outline",2,"margin-right","10px"]],template:function(r,u){1&r&&(i.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),i._UZ(3,"ion-back-button",2),i.qZA(),i.TgZ(4,"ion-title"),i._uU(5,"Historique"),i.qZA()()(),i.TgZ(6,"ion-content",3),i.YNc(7,y,7,2,"ion-list",4),i.qZA()),2&r&&(i.Q6J("translucent",!0),i.xp6(6),i.Q6J("fullscreen",!0),i.xp6(1),i.Q6J("ngForOf",u.magasins))},dependencies:[d.sg,d.O5,f.oU,f.Sm,f.W2,f.Gu,f.gu,f.Ie,f.u8,f.IK,f.td,f.Q$,f.q_,f.wd,f.sr,f.cs]}),o})()}];let t=(()=>{var n;class o{}return(n=o).\u0275fac=function(r){return new(r||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[h.Bz.forChild(e),h.Bz]}),o})(),s=(()=>{var n;class o{}return(n=o).\u0275fac=function(r){return new(r||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[d.ez,c.u5,f.Pc,t]}),o})()},9825:(A,p,a)=>{a.d(p,{f:()=>d});var d=function(c){return c.POST="POST",c.PUT="PUT",c.DELETE="DELETE",c}(d||{})},5423:(A,p,a)=>{a.d(p,{V:()=>I});var d=a(5861),c=a(3009),f=a(9825),h=a(6689),x=a(2014),i=a(2386),m=a(9392),P=a(3182),_=a(553);let Z=(()=>{var g;class y{constructor(e){this.firestore=e}post(e,t,s){return(0,d.Z)(function*(){const n=(0,P.ZF)(_.N.firebaseConfig),o=(0,m.ad)(n);yield(0,i.pl)((0,i.JU)(o,e,s),t)})()}getAll(e){var t=this;return(0,d.Z)(function*(){const s=yield(0,i.hJ)(t.firestore,e);return(0,i.BS)(s)})()}put(e,t,s){var n=this;return(0,d.Z)(function*(){const o=(0,i.JU)(n.firestore,e+"/"+t);return(0,i.r7)(o,s)})()}delete(e,t,s){var n=this;return(0,d.Z)(function*(){const o=(0,i.JU)(n.firestore,e+"/"+t);return(0,i.oe)(o)})()}}return(g=y).\u0275fac=function(e){return new(e||g)(h.LFG(i.gg))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),y})(),I=(()=>{var g;class y{constructor(e,t){this.storage=e,this.firestore=t}postAll(e,t){var s=this;return(0,d.Z)(function*(){(yield s.getConnexionInfo()).isOnline&&(yield(yield t.filter(l=>!l.isFirebase)).map(function(){var l=(0,d.Z)(function*(r){r.isFirebase=!0,yield s.firestore.post(e,r,r.id.toString())});return function(r){return l.apply(this,arguments)}}())),yield s.storage.set(e,t)})()}parseDate(e){const s=new Date(e).getTime();return{nanoseconds:s%1e3*1e6,seconds:Math.floor(s/1e3)}}post(e,t){var s=this;return(0,d.Z)(function*(){var n=yield s.getAll(e);t.id=Number(new Date),t.createdOn=s.parseDate(new Date),t.modifiedOn=null,t.deletedOn=null,t.isFirebase=!1,n.push(t),yield s.postAll(e,n)})()}get(e){var t=this;return(0,d.Z)(function*(){return yield(yield t.storage.get(e)).filter(n=>""===n.deletedOn||null===n.deletedOn||void 0!==n.deletedOn)})()}getAll(e){var t=this;return(0,d.Z)(function*(){return yield t.storage.get(e)})()}getIndex(e,t){var s=this;return(0,d.Z)(function*(){return yield(yield s.getAll(e)).findIndex(o=>o.id===t)})()}put(e,t){var s=this;return(0,d.Z)(function*(){const n=yield s.getAll(e),o=yield s.getIndex(e,t.id);n[o]=t,n[o].modifiedOn=new Date,(yield s.getConnexionInfo()).isOnline?yield s.firestore.put(e,t.id.toString(),t):n[o].isFirebase&&(n[o].firebaseMethod=f.f.PUT),yield s.postAll(e,n)})()}delete(e,t){var s=this;return(0,d.Z)(function*(){const n=yield s.getAll(e),o=yield s.getIndex(e,t.id);n[o].deletedOn=new Date,n[o].firebaseMethod=f.f.DELETE,yield s.postAll(e,n),(yield s.getConnexionInfo()).isOnline&&(yield s.firestore.put(e,t.id.toString(),t))})()}deleteDefinitivement(e,t){var s=this;return(0,d.Z)(function*(){const n=yield s.getAll(e),o=yield s.getIndex(e,t.id);(yield s.getConnexionInfo()).isOnline?(n.splice(o,1),yield s.firestore.delete(e,t.id.toString(),t)):n[o].isFirebase?(n[o].firebaseMethod=f.f.DELETE,n[o].deletedOn=new Date):n.splice(o,1),yield s.postAll(e,n)})()}synchroniserAvecFirestore(){var e=this;return(0,d.Z)(function*(){(yield e.getConnexionInfo()).isOnline?(yield e.synchroniser(c.K.Utilisateurs),yield e.synchroniser(c.K.Articles),yield e.synchroniser(c.K.Courses),yield e.synchroniser(c.K.Familles),yield e.synchroniser(c.K.CourseDetails),yield e.synchroniser(c.K.Memos),yield e.synchroniser(c.K.HistoriquePrix),yield e.synchroniser(c.K.Depenses),yield e.synchroniser(c.K.Apports),yield e.synchroniser(c.K.Epargnes),yield e.synchroniser(c.K.Magasins),yield e.synchroniser(c.K.Plats),yield e.synchroniser(c.K.PlatDetails),yield e.synchroniser(c.K.Groupes),yield e.synchroniser(c.K.Menus),yield e.synchroniser(c.K.Budget)):alert("Le mode onLine est d\xe9sactiv\xe9")})()}synchroniser(e){var t=this;return(0,d.Z)(function*(){if((yield t.getConnexionInfo()).isOnline){const n=yield t.storage.get(e),o=yield n.filter(r=>!r.isFirebase);o.length>0&&o.map(function(){var r=(0,d.Z)(function*(u){u.isFirebase=!0,yield t.firestore.post(e,u,u.id.toString())});return function(u){return r.apply(this,arguments)}}());const l=yield n.filter(r=>r.firebaseMethod===f.f.DELETE||r.firebaseMethod===f.f.PUT);l.length>0&&l.map(function(){var r=(0,d.Z)(function*(u){u.firebaseMethod===f.f.PUT&&(yield t.put(e,u)),u.firebaseMethod===f.f.DELETE&&(yield t.deleteDefinitivement(e,u))});return function(u){return r.apply(this,arguments)}}()),(yield t.firestore.getAll(e)).subscribe(r=>{t.storage.set(e,r)})}else alert("Le mode onLine est d\xe9sactiv\xe9")})()}set(e,t){var s=this;return(0,d.Z)(function*(){yield s.storage.set(e,t)})()}getConnexionInfo(){var e=this;return(0,d.Z)(function*(){return yield e.storage.get(c.K.InfoConnexion)})()}}return(g=y).\u0275fac=function(e){return new(e||g)(h.LFG(x.K),h.LFG(Z))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),y})()}}]);